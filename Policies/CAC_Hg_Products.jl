#
# CAC_Hg_Products.jl - This jl models the VOC in certain products (SOR/2021-268) Regulations
# 
# This TXP Models emission reductions to the Iron&Steel sector in Ontario
# These reductions are associated with the Algoma and Arcelor projects 
# Where conversion to DRI-EAF will lead to significant reductions from these 2 plants
# Since the impact of these projects is mostly captured in FsDmd, but no AP emissions are produced from it
# Pro-rating the impact to combustion and process emissions to obtain anticipated levels of emissions. 
# The assumptions were taken from 2022 Projection sent to EAD (Oct 21, 2022)_Iron&STeel.xlsx 
# Received from the Metals and Minerals Processing Division on Oct 21 2022
# Proportional reduction were applied to Ref22 to develop the Pollution Coefficient Reduction Multipliers
# See 2022 Iron&Steel projections_AB_221103.xlsx for detail calculations
# These assumptions should be reviewed yearly 
# By Audrey Bernard 22.10.24

using SmallModel

module CAC_Hg_Products

import ...SmallModel: ReadDisk,WriteDisk,Select
import ...SmallModel: HisTime,ITime,MaxTime,First,Future,Final,Yr
import ...SmallModel: @finite_math,finite_inverse,finite_divide,finite_power,finite_exp,finite_log
import ...SmallModel: DB

const VariableArray{N} = Array{Float64,N} where {N}
const SetArray = Vector{String}

Base.@kwdef struct MControl
  db::String

  MEInput::String = "MEInput"
  BCNameDB::String = ReadDisk(db,"E2020DB/BCNameDB") #  Base Case Name

  Area::SetArray = ReadDisk(db,"E2020DB/AreaKey")
  AreaDS::SetArray = ReadDisk(db,"E2020DB/AreaDS")
  Areas::Vector{Int} = collect(Select(Area))
  ECC::SetArray = ReadDisk(db,"E2020DB/ECCKey")
  ECCDS::SetArray = ReadDisk(db,"E2020DB/ECCDS")
  ECCs::Vector{Int} = collect(Select(ECC))
  Nation::SetArray = ReadDisk(db,"E2020DB/NationKey")
  NationDS::SetArray = ReadDisk(db,"E2020DB/NationDS")
  Nations::Vector{Int} = collect(Select(Nation))
  Poll::SetArray = ReadDisk(db,"E2020DB/PollKey")
  PollDS::SetArray = ReadDisk(db,"E2020DB/PollDS")
  Polls::Vector{Int} = collect(Select(Poll))
  Year::SetArray = ReadDisk(db,"E2020DB/YearKey")
  YearDS::SetArray = ReadDisk(db,"E2020DB/YearDS")
  Years::Vector{Int} = collect(Select(Year))

  ANMap::VariableArray{2} = ReadDisk(db,"E2020DB/ANMap") # Map between Area and Nation [Area,Nation]
  MEPOCX::VariableArray{4} = ReadDisk(db,"MEInput/MEPOCX") # [ECC,Poll,Area,Year] Non-Energy Pollution Coefficient (Tonnes/Economic Driver)

  # Scratch Variables
  Reduce::VariableArray{4} = zeros(Float64,length(ECC),length(Poll),length(Area),length(Year)) # [ECC,Poll,Area,Year] Scratch Variable For Input Reductions
end

function MacroPolicy(db)
  data = MControl(; db)
  (; Area,ECC,Poll,Nation) = data
  (; MEInput) = data
  (; ANMap,MEPOCX,Reduce) = data

  #
  # RESIDENTIAL SECTORS
  #
  poll = Select(Poll,"Hg")
  years = collect(Yr(2026):Yr(2050))
  eccs = Select(ECC,["SingleFamilyDetached","SingleFamilyAttached"])

  area = Select(Area,"AB")
  Reduce[eccs,poll,area,years] .= [
    #/Hg                        2026      2027    2028    2029    2030    2031    2032    2033    2034    2035    2036    2037    2038    2039    2040    2041    2042    2043    2044    2045    2046    2047    2048    2049    2050 
    #=SingleFamily D=#        0.0504    0.0499  0.0493  0.0487  0.0481  0.0476  0.0472  0.0468  0.0465  0.0462  0.0462  0.0462  0.0462  0.0462  0.0462  0.0462  0.0462  0.0462  0.0462  0.0462  0.0462  0.0462  0.0462  0.0462  0.0462
    #=SingleFamily A=#        0.0466    0.0453  0.0439  0.0424  0.0410  0.0398  0.0387  0.0378  0.0370  0.0364  0.0364  0.0364  0.0364  0.0364  0.0364  0.0364  0.0364  0.0364  0.0364  0.0364  0.0364  0.0364  0.0364  0.0364  0.0364
    ]
  
  area = Select(Area,"BC")
  Reduce[eccs,poll,area,years] .= [
    #/Hg                        2026      2027    2028    2029    2030    2031    2032    2033    2034    2035    2036    2037    2038    2039    2040    2041    2042    2043    2044    2045    2046    2047    2048    2049    2050 
    #=SingleFamily D=#        0.0583    0.0581  0.0579  0.0577  0.0574  0.0573  0.0571  0.0570  0.0569  0.0569  0.0569  0.0569  0.0569  0.0569  0.0569  0.0569  0.0569  0.0569  0.0569  0.0569  0.0569  0.0569  0.0569  0.0569  0.0569
    #=SingleFamily A=#        0.0542    0.0533  0.0522  0.0512  0.0502  0.0494  0.0487  0.0481  0.0476  0.0472  0.0472  0.0472  0.0472  0.0472  0.0472  0.0472  0.0472  0.0472  0.0472  0.0472  0.0472  0.0472  0.0472  0.0472  0.0472
    ]
  
  area = Select(Area,"SK")
  Reduce[eccs,poll,area,years] .= [
    #/Hg                        2026      2027    2028    2029    2030    2031    2032    2033    2034    2035    2036    2037    2038    2039    2040    2041    2042    2043    2044    2045    2046    2047    2048    2049    2050 
    #=SingleFamily D=#        0.0468    0.0466  0.0463  0.0460  0.0456  0.0453  0.0449  0.0447  0.0445  0.0443  0.0443  0.0443  0.0443  0.0443  0.0443  0.0443  0.0443  0.0443  0.0443  0.0443  0.0443  0.0443  0.0443  0.0443  0.0443
    #=SingleFamily A=#        0.0447    0.0436  0.0421  0.0404  0.0387  0.0371  0.0357  0.0345  0.0335  0.0327  0.0327  0.0327  0.0327  0.0327  0.0327  0.0327  0.0327  0.0327  0.0327  0.0327  0.0327  0.0327  0.0327  0.0327  0.0327
    ]
  
  area = Select(Area,"MB")
  Reduce[eccs,poll,area,years] .= [
    #/Hg                        2026      2027    2028    2029    2030    2031    2032    2033    2034    2035    2036    2037    2038    2039    2040    2041    2042    2043    2044    2045    2046    2047    2048    2049    2050 
    #=SingleFamily D=#        0.0592    0.0590  0.0587  0.0583  0.0579  0.0575  0.0571  0.0568  0.0565  0.0562  0.0562  0.0562  0.0562  0.0562  0.0562  0.0562  0.0562  0.0562  0.0562  0.0562  0.0562  0.0562  0.0562  0.0562  0.0562
    #=SingleFamily A=#        0.0532    0.0522  0.0509  0.0495  0.0482  0.0469  0.0457  0.0447  0.0438  0.0430  0.0430  0.0430  0.0430  0.0430  0.0430  0.0430  0.0430  0.0430  0.0430  0.0430  0.0430  0.0430  0.0430  0.0430  0.0430
    ]

  area = Select(Area,"ON")
  Reduce[eccs,poll,area,years] .= [
    #/Hg                        2026      2027    2028    2029    2030    2031    2032    2033    2034    2035    2036    2037    2038    2039    2040    2041    2042    2043    2044    2045    2046    2047    2048    2049    2050 
    #=SingleFamily D=#        0.0557    0.0554  0.0551  0.0548  0.0545  0.0542  0.0539  0.0537  0.0535  0.0534  0.0534  0.0534  0.0534  0.0534  0.0534  0.0534  0.0534  0.0534  0.0534  0.0534  0.0534  0.0534  0.0534  0.0534  0.0534
    #=SingleFamily A=#        0.0534    0.0527  0.0519  0.0512  0.0504  0.0497  0.0491  0.0486  0.0482  0.0478  0.0478  0.0478  0.0478  0.0478  0.0478  0.0478  0.0478  0.0478  0.0478  0.0478  0.0478  0.0478  0.0478  0.0478  0.0478
    ]

  area = Select(Area,"QC")
  Reduce[eccs,poll,area,years] .= [
    #/Hg                        2026      2027    2028    2029    2030    2031    2032    2033    2034    2035    2036    2037    2038    2039    2040    2041    2042    2043    2044    2045    2046    2047    2048    2049    2050 
    #=SingleFamily D=#        0.0555    0.0555  0.0554  0.0553  0.0553  0.0552  0.0552  0.0552  0.0552  0.0552  0.0552  0.0552  0.0552  0.0552  0.0552  0.0552  0.0552  0.0552  0.0552  0.0552  0.0552  0.0552  0.0552  0.0552  0.0552
    #=SingleFamily A=#        0.0536    0.0534  0.0532  0.0529  0.0527  0.0524  0.0522  0.0520  0.0519  0.0518  0.0518  0.0518  0.0518  0.0518  0.0518  0.0518  0.0518  0.0518  0.0518  0.0518  0.0518  0.0518  0.0518  0.0518  0.0518
    ]

  area = Select(Area,"NB")
  Reduce[eccs,poll,area,years] .= [
    #/Hg                        2026      2027    2028    2029    2030    2031    2032    2033    2034    2035    2036    2037    2038    2039    2040    2041    2042    2043    2044    2045    2046    2047    2048    2049    2050 
    #=SingleFamily D=#        0.0519    0.0517  0.0514  0.0510  0.0507  0.0505  0.0503  0.0501  0.0500  0.0499  0.0499  0.0499  0.0499  0.0499  0.0499  0.0499  0.0499  0.0499  0.0499  0.0499  0.0499  0.0499  0.0499  0.0499  0.0499
    #=SingleFamily A=#        0.0487    0.0471  0.0454  0.0439  0.0424  0.0412  0.0401  0.0393  0.0386  0.0380  0.0380  0.0380  0.0380  0.0380  0.0380  0.0380  0.0380  0.0380  0.0380  0.0380  0.0380  0.0380  0.0380  0.0380  0.0380
    ]
  
  area = Select(Area,"NS")
  Reduce[eccs,poll,area,years] .= [
    #/Hg                        2026      2027    2028    2029    2030    2031    2032    2033    2034    2035    2036    2037    2038    2039    2040    2041    2042    2043    2044    2045    2046    2047    2048    2049    2050 
    #=SingleFamily D=#        0.0765    0.0760  0.0755  0.0749  0.0745  0.0741  0.0738  0.0736  0.0734  0.0733  0.0733  0.0733  0.0733  0.0733  0.0733  0.0733  0.0733  0.0733  0.0733  0.0733  0.0733  0.0733  0.0733  0.0733  0.0733
    #=SingleFamily A=#        0.0718    0.0706  0.0692  0.0678  0.0666  0.0656  0.0647  0.0640  0.0634  0.0629  0.0629  0.0629  0.0629  0.0629  0.0629  0.0629  0.0629  0.0629  0.0629  0.0629  0.0629  0.0629  0.0629  0.0629  0.0629
    ]

  area = Select(Area,"NL")
  Reduce[eccs,poll,area,years] .= [
    #/Hg                        2026      2027    2028    2029    2030    2031    2032    2033    2034    2035    2036    2037    2038    2039    2040    2041    2042    2043    2044    2045    2046    2047    2048    2049    2050 
    #=SingleFamily D=#        0.0556    0.0552  0.0547  0.0541  0.0537  0.0533  0.0529  0.0527  0.0526  0.0525  0.0525  0.0525  0.0525  0.0525  0.0525  0.0525  0.0525  0.0525  0.0525  0.0525  0.0525  0.0525  0.0525  0.0525  0.0525
    #=SingleFamily A=#        0.0553    0.0547  0.0539  0.0531  0.0523  0.0516  0.0511  0.0506  0.0503  0.0501  0.0501  0.0501  0.0501  0.0501  0.0501  0.0501  0.0501  0.0501  0.0501  0.0501  0.0501  0.0501  0.0501  0.0501  0.0501
    ]

  area = Select(Area,"PE")
  Reduce[eccs,poll,area,years] .= [
    #/Hg                        2026      2027    2028    2029    2030    2031    2032    2033    2034    2035    2036    2037    2038    2039    2040    2041    2042    2043    2044    2045    2046    2047    2048    2049    2050 
    #=SingleFamily D=#        0.0703    0.0700  0.0696  0.0691  0.0686  0.0681  0.0677  0.0673  0.0670  0.0667  0.0667  0.0667  0.0667  0.0667  0.0667  0.0667  0.0667  0.0667  0.0667  0.0667  0.0667  0.0667  0.0667  0.0667  0.0667
    #=SingleFamily A=#        0.0621    0.0608  0.0591  0.0572  0.0554  0.0537  0.0521  0.0508  0.0497  0.0487  0.0487  0.0487  0.0487  0.0487  0.0487  0.0487  0.0487  0.0487  0.0487  0.0487  0.0487  0.0487  0.0487  0.0487  0.0487
    ]

  area = Select(Area,"YT")
  Reduce[eccs,poll,area,years] .= [
    #/Hg                        2026      2027    2028    2029    2030    2031    2032    2033    2034    2035    2036    2037    2038    2039    2040    2041    2042    2043    2044    2045    2046    2047    2048    2049    2050 
    #=SingleFamily D=#        0.0656    0.0648  0.0639  0.0631  0.0622  0.0614  0.0605  0.0596  0.0587  0.0579  0.0579  0.0579  0.0579  0.0579  0.0579  0.0579  0.0579  0.0579  0.0579  0.0579  0.0579  0.0579  0.0579  0.0579  0.0579
    #=SingleFamily A=#        0.0624    0.0607  0.0591  0.0576  0.0561  0.0547  0.0533  0.0520  0.0508  0.0496  0.0496  0.0496  0.0496  0.0496  0.0496  0.0496  0.0496  0.0496  0.0496  0.0496  0.0496  0.0496  0.0496  0.0496  0.0496
    ]

  area = Select(Area,"NT")
  Reduce[eccs,poll,area,years] .= [
    #/Hg                        2026      2027    2028    2029    2030    2031    2032    2033    2034    2035    2036    2037    2038    2039    2040    2041    2042    2043    2044    2045    2046    2047    2048    2049    2050 
    #=SingleFamily D=#        0.0660    0.0656  0.0653  0.0649  0.0646  0.0642  0.0639  0.0635  0.0632  0.0628  0.0628  0.0628  0.0628  0.0628  0.0628  0.0628  0.0628  0.0628  0.0628  0.0628  0.0628  0.0628  0.0628  0.0628  0.0628
    #=SingleFamily A=#        0.0630    0.0617  0.0604  0.0592  0.0580  0.0569  0.0559  0.0549  0.0540  0.0531  0.0531  0.0531  0.0531  0.0531  0.0531  0.0531  0.0531  0.0531  0.0531  0.0531  0.0531  0.0531  0.0531  0.0531  0.0531
    ]

  area = Select(Area,"NU")
  Reduce[eccs,poll,area,years] .= [
    #/Hg                        2026      2027    2028    2029    2030    2031    2032    2033    2034    2035    2036    2037    2038    2039    2040    2041    2042    2043    2044    2045    2046    2047    2048    2049    2050 
    #=SingleFamily D=#        0.0585    0.0573  0.0560  0.0547  0.0534  0.0521  0.0508  0.0496  0.0484  0.0473  0.0473  0.0473  0.0473  0.0473  0.0473  0.0473  0.0473  0.0473  0.0473  0.0473  0.0473  0.0473  0.0473  0.0473  0.0473
    #=SingleFamily A=#        0.0550    0.0537  0.0525  0.0514  0.0503  0.0494  0.0484  0.0475  0.0467  0.0458  0.0458  0.0458  0.0458  0.0458  0.0458  0.0458  0.0458  0.0458  0.0458  0.0458  0.0458  0.0458  0.0458  0.0458  0.0458
    ]
  
  #
  # Apply reductions to coefficient
  #
  nation = Select(Nation,"CN")
  areas = findall(ANMap[:,nation] .== 1.0)
  for ecc in eccs, area in areas, year in years
    MEPOCX[ecc,poll,area,year] = MEPOCX[ecc,poll,area,year]*(1-Reduce[ecc,poll,area,year])
  end

  #
  #COMMERCIAL SECTORS*
  #
  eccs = Select(ECC,["OtherCommercial","Education","Health",
                     "Information","Offices","Retail","Warehouse","Wholesale"])

  area = Select(Area,"AB")
  Reduce[eccs,poll,area,years] .= [
    #/Hg                        2026      2027    2028    2029    2030    2031    2032    2033    2034    2035    2036    2037    2038    2039    2040    2041    2042    2043    2044    2045    2046    2047    2048    2049    2050 
    #=OtherCommercial=#       0.0414    0.0405  0.0396  0.0387  0.0379  0.0370  0.0361  0.0352  0.0343  0.0335  0.0335  0.0335  0.0335  0.0335  0.0335  0.0335  0.0335  0.0335  0.0335  0.0335  0.0335  0.0335  0.0335  0.0335  0.0335
    #=Education      =#       0.0379    0.0371  0.0364  0.0357  0.0350  0.0342  0.0335  0.0328  0.0320  0.0313  0.0313  0.0313  0.0313  0.0313  0.0313  0.0313  0.0313  0.0313  0.0313  0.0313  0.0313  0.0313  0.0313  0.0313  0.0313
    #=Health         =#       0.0390    0.0383  0.0377  0.0370  0.0364  0.0357  0.0350  0.0343  0.0336  0.0329  0.0329  0.0329  0.0329  0.0329  0.0329  0.0329  0.0329  0.0329  0.0329  0.0329  0.0329  0.0329  0.0329  0.0329  0.0329
    #=Information    =#       0.0405    0.0395  0.0384  0.0374  0.0365  0.0355  0.0345  0.0335  0.0326  0.0317  0.0317  0.0317  0.0317  0.0317  0.0317  0.0317  0.0317  0.0317  0.0317  0.0317  0.0317  0.0317  0.0317  0.0317  0.0317
    #=Offices        =#       0.0406    0.0403  0.0401  0.0398  0.0395  0.0391  0.0388  0.0384  0.0380  0.0376  0.0376  0.0376  0.0376  0.0376  0.0376  0.0376  0.0376  0.0376  0.0376  0.0376  0.0376  0.0376  0.0376  0.0376  0.0376
    #=Retail         =#       0.0401    0.0397  0.0393  0.0389  0.0384  0.0379  0.0374  0.0368  0.0363  0.0357  0.0357  0.0357  0.0357  0.0357  0.0357  0.0357  0.0357  0.0357  0.0357  0.0357  0.0357  0.0357  0.0357  0.0357  0.0357
    #=Warehouse      =#       0.0395    0.0392  0.0390  0.0387  0.0383  0.0380  0.0376  0.0372  0.0367  0.0363  0.0363  0.0363  0.0363  0.0363  0.0363  0.0363  0.0363  0.0363  0.0363  0.0363  0.0363  0.0363  0.0363  0.0363  0.0363
    #=Wholesale      =#       0.0421    0.0416  0.0412  0.0408  0.0403  0.0397  0.0392  0.0386  0.0380  0.0375  0.0375  0.0375  0.0375  0.0375  0.0375  0.0375  0.0375  0.0375  0.0375  0.0375  0.0375  0.0375  0.0375  0.0375  0.0375
    ]
  
  area = Select(Area,"BC")
  Reduce[eccs,poll,area,years] .= [
    #/Hg                        2026      2027    2028    2029    2030    2031    2032    2033    2034    2035    2036    2037    2038    2039    2040    2041    2042    2043    2044    2045    2046    2047    2048    2049    2050 
    #=OtherCommercial=#       0.0446    0.0437  0.0428  0.0419  0.0411  0.0403  0.0396  0.0389  0.0382  0.0375  0.0375  0.0375  0.0375  0.0375  0.0375  0.0375  0.0375  0.0375  0.0375  0.0375  0.0375  0.0375  0.0375  0.0375  0.0375
    #=Education      =#       0.0423    0.0417  0.0412  0.0408  0.0403  0.0398  0.0393  0.0389  0.0384  0.0380  0.0380  0.0380  0.0380  0.0380  0.0380  0.0380  0.0380  0.0380  0.0380  0.0380  0.0380  0.0380  0.0380  0.0380  0.0380
    #=Health         =#       0.0439    0.0439  0.0439  0.0439  0.0439  0.0438  0.0438  0.0438  0.0437  0.0436  0.0436  0.0436  0.0436  0.0436  0.0436  0.0436  0.0436  0.0436  0.0436  0.0436  0.0436  0.0436  0.0436  0.0436  0.0436
    #=Information    =#       0.0453    0.0450  0.0446  0.0442  0.0437  0.0432  0.0426  0.0420  0.0414  0.0408  0.0408  0.0408  0.0408  0.0408  0.0408  0.0408  0.0408  0.0408  0.0408  0.0408  0.0408  0.0408  0.0408  0.0408  0.0408
    #=Offices        =#       0.0445    0.0440  0.0436  0.0432  0.0428  0.0424  0.0420  0.0415  0.0411  0.0407  0.0407  0.0407  0.0407  0.0407  0.0407  0.0407  0.0407  0.0407  0.0407  0.0407  0.0407  0.0407  0.0407  0.0407  0.0407
    #=Retail         =#       0.0451    0.0446  0.0440  0.0435  0.0431  0.0426  0.0421  0.0416  0.0411  0.0406  0.0406  0.0406  0.0406  0.0406  0.0406  0.0406  0.0406  0.0406  0.0406  0.0406  0.0406  0.0406  0.0406  0.0406  0.0406
    #=Warehouse      =#       0.0414    0.0417  0.0420  0.0423  0.0425  0.0426  0.0428  0.0429  0.0430  0.0431  0.0431  0.0431  0.0431  0.0431  0.0431  0.0431  0.0431  0.0431  0.0431  0.0431  0.0431  0.0431  0.0431  0.0431  0.0431
    #=Wholesale      =#       0.0489    0.0483  0.0478  0.0472  0.0467  0.0462  0.0457  0.0451  0.0446  0.0441  0.0441  0.0441  0.0441  0.0441  0.0441  0.0441  0.0441  0.0441  0.0441  0.0441  0.0441  0.0441  0.0441  0.0441  0.0441
    ]
  
  area = Select(Area,"SK")
  Reduce[eccs,poll,area,years] .= [
    #/Hg                        2026      2027    2028    2029    2030    2031    2032    2033    2034    2035    2036    2037    2038    2039    2040    2041    2042    2043    2044    2045    2046    2047    2048    2049    2050 
    #=OtherCommercial=#       0.0392    0.0386  0.0381  0.0375  0.0369  0.0364  0.0359  0.0354  0.0349  0.0344  0.0344  0.0344  0.0344  0.0344  0.0344  0.0344  0.0344  0.0344  0.0344  0.0344  0.0344  0.0344  0.0344  0.0344  0.0344
    #=Education      =#       0.0353    0.0355  0.0358  0.0360  0.0362  0.0365  0.0367  0.0369  0.0371  0.0373  0.0373  0.0373  0.0373  0.0373  0.0373  0.0373  0.0373  0.0373  0.0373  0.0373  0.0373  0.0373  0.0373  0.0373  0.0373
    #=Health         =#       0.0358    0.0349  0.0340  0.0332  0.0324  0.0316  0.0309  0.0302  0.0295  0.0289  0.0289  0.0289  0.0289  0.0289  0.0289  0.0289  0.0289  0.0289  0.0289  0.0289  0.0289  0.0289  0.0289  0.0289  0.0289
    #=Information    =#       0.0386    0.0402  0.0420  0.0439  0.0458  0.0479  0.0500  0.0523  0.0547  0.0572  0.0572  0.0572  0.0572  0.0572  0.0572  0.0572  0.0572  0.0572  0.0572  0.0572  0.0572  0.0572  0.0572  0.0572  0.0572
    #=Offices        =#       0.0377    0.0376  0.0375  0.0374  0.0372  0.0371  0.0369  0.0368  0.0366  0.0365  0.0365  0.0365  0.0365  0.0365  0.0365  0.0365  0.0365  0.0365  0.0365  0.0365  0.0365  0.0365  0.0365  0.0365  0.0365
    #=Retail         =#       0.0374    0.0375  0.0375  0.0376  0.0376  0.0376  0.0376  0.0376  0.0376  0.0375  0.0375  0.0375  0.0375  0.0375  0.0375  0.0375  0.0375  0.0375  0.0375  0.0375  0.0375  0.0375  0.0375  0.0375  0.0375
    #=Warehouse      =#       0.0397    0.0391  0.0386  0.0381  0.0376  0.0370  0.0365  0.0360  0.0355  0.0350  0.0350  0.0350  0.0350  0.0350  0.0350  0.0350  0.0350  0.0350  0.0350  0.0350  0.0350  0.0350  0.0350  0.0350  0.0350
    #=Wholesale      =#       0.0398    0.0398  0.0399  0.0400  0.0400  0.0400  0.0400  0.0400  0.0400  0.0399  0.0399  0.0399  0.0399  0.0399  0.0399  0.0399  0.0399  0.0399  0.0399  0.0399  0.0399  0.0399  0.0399  0.0399  0.0399
    ]
  
  area = Select(Area,"MB")
  Reduce[eccs,poll,area,years] .= [
    #/Hg                        2026      2027    2028    2029    2030    2031    2032    2033    2034    2035    2036    2037    2038    2039    2040    2041    2042    2043    2044    2045    2046    2047    2048    2049    2050 
    #=OtherCommercial=#       0.0456    0.0445  0.0434  0.0423  0.0413  0.0403  0.0393  0.0384  0.0375  0.0366  0.0366  0.0366  0.0366  0.0366  0.0366  0.0366  0.0366  0.0366  0.0366  0.0366  0.0366  0.0366  0.0366  0.0366  0.0366
    #=Education      =#       0.0417    0.0407  0.0398  0.0389  0.0380  0.0371  0.0363  0.0354  0.0346  0.0338  0.0338  0.0338  0.0338  0.0338  0.0338  0.0338  0.0338  0.0338  0.0338  0.0338  0.0338  0.0338  0.0338  0.0338  0.0338
    #=Health         =#       0.0443    0.0428  0.0415  0.0402  0.0390  0.0379  0.0368  0.0357  0.0347  0.0337  0.0337  0.0337  0.0337  0.0337  0.0337  0.0337  0.0337  0.0337  0.0337  0.0337  0.0337  0.0337  0.0337  0.0337  0.0337
    #=Information    =#       0.0451    0.0453  0.0456  0.0459  0.0461  0.0464  0.0467  0.0468  0.0470  0.0471  0.0471  0.0471  0.0471  0.0471  0.0471  0.0471  0.0471  0.0471  0.0471  0.0471  0.0471  0.0471  0.0471  0.0471  0.0471
    #=Offices        =#       0.0451    0.0450  0.0449  0.0448  0.0447  0.0446  0.0445  0.0443  0.0441  0.0439  0.0439  0.0439  0.0439  0.0439  0.0439  0.0439  0.0439  0.0439  0.0439  0.0439  0.0439  0.0439  0.0439  0.0439  0.0439
    #=Retail         =#       0.0447    0.0453  0.0460  0.0466  0.0472  0.0478  0.0484  0.0489  0.0493  0.0498  0.0498  0.0498  0.0498  0.0498  0.0498  0.0498  0.0498  0.0498  0.0498  0.0498  0.0498  0.0498  0.0498  0.0498  0.0498
    #=Warehouse      =#       0.0416    0.0422  0.0428  0.0434  0.0440  0.0446  0.0452  0.0457  0.0463  0.0468  0.0468  0.0468  0.0468  0.0468  0.0468  0.0468  0.0468  0.0468  0.0468  0.0468  0.0468  0.0468  0.0468  0.0468  0.0468
    #=Wholesale      =#       0.0500    0.0506  0.0514  0.0521  0.0528  0.0534  0.0540  0.0546  0.0551  0.0556  0.0556  0.0556  0.0556  0.0556  0.0556  0.0556  0.0556  0.0556  0.0556  0.0556  0.0556  0.0556  0.0556  0.0556  0.0556
    ]

  area = Select(Area,"ON")
  Reduce[eccs,poll,area,years] .= [
    #/Hg                        2026      2027    2028    2029    2030    2031    2032    2033    2034    2035    2036    2037    2038    2039    2040    2041    2042    2043    2044    2045    2046    2047    2048    2049    2050 
    #=OtherCommercial=#       0.0447    0.0442  0.0438  0.0434  0.0429  0.0424  0.0418  0.0413  0.0407  0.0401  0.0401  0.0401  0.0401  0.0401  0.0401  0.0401  0.0401  0.0401  0.0401  0.0401  0.0401  0.0401  0.0401  0.0401  0.0401
    #=Education      =#       0.0414    0.0411  0.0408  0.0405  0.0402  0.0398  0.0394  0.0390  0.0386  0.0381  0.0381  0.0381  0.0381  0.0381  0.0381  0.0381  0.0381  0.0381  0.0381  0.0381  0.0381  0.0381  0.0381  0.0381  0.0381
    #=Health         =#       0.0425    0.0415  0.0405  0.0396  0.0386  0.0377  0.0368  0.0359  0.0350  0.0341  0.0341  0.0341  0.0341  0.0341  0.0341  0.0341  0.0341  0.0341  0.0341  0.0341  0.0341  0.0341  0.0341  0.0341  0.0341
    #=Information    =#       0.0427    0.0438  0.0450  0.0462  0.0474  0.0486  0.0499  0.0512  0.0525  0.0538  0.0538  0.0538  0.0538  0.0538  0.0538  0.0538  0.0538  0.0538  0.0538  0.0538  0.0538  0.0538  0.0538  0.0538  0.0538
    #=Offices        =#       0.0433    0.0434  0.0434  0.0435  0.0435  0.0434  0.0433  0.0432  0.0430  0.0428  0.0428  0.0428  0.0428  0.0428  0.0428  0.0428  0.0428  0.0428  0.0428  0.0428  0.0428  0.0428  0.0428  0.0428  0.0428
    #=Retail         =#       0.0428    0.0425  0.0423  0.0420  0.0417  0.0414  0.0410  0.0405  0.0401  0.0396  0.0396  0.0396  0.0396  0.0396  0.0396  0.0396  0.0396  0.0396  0.0396  0.0396  0.0396  0.0396  0.0396  0.0396  0.0396
    #=Warehouse      =#       0.0418    0.0415  0.0412  0.0409  0.0406  0.0403  0.0400  0.0397  0.0393  0.0390  0.0390  0.0390  0.0390  0.0390  0.0390  0.0390  0.0390  0.0390  0.0390  0.0390  0.0390  0.0390  0.0390  0.0390  0.0390
    #=Wholesale      =#       0.0392    0.0390  0.0388  0.0385  0.0383  0.0379  0.0376  0.0372  0.0368  0.0363  0.0363  0.0363  0.0363  0.0363  0.0363  0.0363  0.0363  0.0363  0.0363  0.0363  0.0363  0.0363  0.0363  0.0363  0.0363
    ]

  area = Select(Area,"QC")
  Reduce[eccs,poll,area,years] .= [
    #/Hg                        2026      2027    2028    2029    2030    2031    2032    2033    2034    2035    2036    2037    2038    2039    2040    2041    2042    2043    2044    2045    2046    2047    2048    2049    2050 
    #=OtherCommercial=#       0.0462    0.0454  0.0447  0.0440  0.0432  0.0425  0.0417  0.0410  0.0402  0.0395  0.0395  0.0395  0.0395  0.0395  0.0395  0.0395  0.0395  0.0395  0.0395  0.0395  0.0395  0.0395  0.0395  0.0395  0.0395
    #=Education      =#       0.0408    0.0406  0.0404  0.0401  0.0399  0.0396  0.0393  0.0389  0.0386  0.0382  0.0382  0.0382  0.0382  0.0382  0.0382  0.0382  0.0382  0.0382  0.0382  0.0382  0.0382  0.0382  0.0382  0.0382  0.0382
    #=Health         =#       0.0420    0.0413  0.0406  0.0399  0.0392  0.0385  0.0378  0.0372  0.0365  0.0358  0.0358  0.0358  0.0358  0.0358  0.0358  0.0358  0.0358  0.0358  0.0358  0.0358  0.0358  0.0358  0.0358  0.0358  0.0358
    #=Information    =#       0.0443    0.0457  0.0471  0.0484  0.0498  0.0511  0.0524  0.0536  0.0548  0.0558  0.0558  0.0558  0.0558  0.0558  0.0558  0.0558  0.0558  0.0558  0.0558  0.0558  0.0558  0.0558  0.0558  0.0558  0.0558
    #=Offices        =#       0.0427    0.0426  0.0426  0.0426  0.0425  0.0424  0.0422  0.0421  0.0419  0.0417  0.0417  0.0417  0.0417  0.0417  0.0417  0.0417  0.0417  0.0417  0.0417  0.0417  0.0417  0.0417  0.0417  0.0417  0.0417
    #=Retail         =#       0.0426    0.0424  0.0423  0.0422  0.0420  0.0419  0.0416  0.0414  0.0411  0.0408  0.0408  0.0408  0.0408  0.0408  0.0408  0.0408  0.0408  0.0408  0.0408  0.0408  0.0408  0.0408  0.0408  0.0408  0.0408
    #=Warehouse      =#       0.0449    0.0445  0.0441  0.0437  0.0432  0.0428  0.0422  0.0417  0.0412  0.0406  0.0406  0.0406  0.0406  0.0406  0.0406  0.0406  0.0406  0.0406  0.0406  0.0406  0.0406  0.0406  0.0406  0.0406  0.0406
    #=Wholesale      =#       0.0446    0.0444  0.0443  0.0442  0.0440  0.0438  0.0436  0.0433  0.0430  0.0427  0.0427  0.0427  0.0427  0.0427  0.0427  0.0427  0.0427  0.0427  0.0427  0.0427  0.0427  0.0427  0.0427  0.0427  0.0427
    ]

  area = Select(Area,"NB")
  Reduce[eccs,poll,area,years] .= [
    #/Hg                        2026      2027    2028    2029    2030    2031    2032    2033    2034    2035    2036    2037    2038    2039    2040    2041    2042    2043    2044    2045    2046    2047    2048    2049    2050 
    #=OtherCommercial=#       0.0449    0.0446  0.0443  0.0440  0.0438  0.0436  0.0434  0.0432  0.0429  0.0427  0.0427  0.0427  0.0427  0.0427  0.0427  0.0427  0.0427  0.0427  0.0427  0.0427  0.0427  0.0427  0.0427  0.0427  0.0427
    #=Education      =#       0.0396    0.0398  0.0399  0.0401  0.0402  0.0404  0.0406  0.0407  0.0409  0.0410  0.0410  0.0410  0.0410  0.0410  0.0410  0.0410  0.0410  0.0410  0.0410  0.0410  0.0410  0.0410  0.0410  0.0410  0.0410
    #=Health         =#       0.0416    0.0422  0.0429  0.0435  0.0443  0.0450  0.0457  0.0465  0.0472  0.0479  0.0479  0.0479  0.0479  0.0479  0.0479  0.0479  0.0479  0.0479  0.0479  0.0479  0.0479  0.0479  0.0479  0.0479  0.0479
    #=Information    =#       0.0417    0.0428  0.0438  0.0448  0.0457  0.0468  0.0479  0.0491  0.0503  0.0514  0.0514  0.0514  0.0514  0.0514  0.0514  0.0514  0.0514  0.0514  0.0514  0.0514  0.0514  0.0514  0.0514  0.0514  0.0514
    #=Offices        =#       0.0418    0.0418  0.0417  0.0417  0.0417  0.0417  0.0416  0.0416  0.0416  0.0415  0.0415  0.0415  0.0415  0.0415  0.0415  0.0415  0.0415  0.0415  0.0415  0.0415  0.0415  0.0415  0.0415  0.0415  0.0415
    #=Retail         =#       0.0410    0.0407  0.0404  0.0402  0.0399  0.0397  0.0394  0.0392  0.0389  0.0387  0.0387  0.0387  0.0387  0.0387  0.0387  0.0387  0.0387  0.0387  0.0387  0.0387  0.0387  0.0387  0.0387  0.0387  0.0387
    #=Warehouse      =#       0.0423    0.0420  0.0417  0.0413  0.0410  0.0407  0.0404  0.0401  0.0398  0.0396  0.0396  0.0396  0.0396  0.0396  0.0396  0.0396  0.0396  0.0396  0.0396  0.0396  0.0396  0.0396  0.0396  0.0396  0.0396
    #=Wholesale      =#       0.0459    0.0456  0.0453  0.0450  0.0447  0.0444  0.0442  0.0439  0.0436  0.0433  0.0433  0.0433  0.0433  0.0433  0.0433  0.0433  0.0433  0.0433  0.0433  0.0433  0.0433  0.0433  0.0433  0.0433  0.0433
    ]
  
  area = Select(Area,"NS")
  Reduce[eccs,poll,area,years] .= [
    #/Hg                        2026      2027    2028    2029    2030    2031    2032    2033    2034    2035    2036    2037    2038    2039    2040    2041    2042    2043    2044    2045    2046    2047    2048    2049    2050 
    #=OtherCommercial=#       0.0580    0.0575  0.0570  0.0566  0.0561  0.0556  0.0551  0.0546  0.0541  0.0536  0.0536  0.0536  0.0536  0.0536  0.0536  0.0536  0.0536  0.0536  0.0536  0.0536  0.0536  0.0536  0.0536  0.0536  0.0536
    #=Education      =#       0.0515    0.0516  0.0518  0.0519  0.0520  0.0521  0.0521  0.0521  0.0520  0.0520  0.0520  0.0520  0.0520  0.0520  0.0520  0.0520  0.0520  0.0520  0.0520  0.0520  0.0520  0.0520  0.0520  0.0520  0.0520
    #=Health         =#       0.0551    0.0560  0.0570  0.0580  0.0589  0.0598  0.0606  0.0615  0.0623  0.0631  0.0631  0.0631  0.0631  0.0631  0.0631  0.0631  0.0631  0.0631  0.0631  0.0631  0.0631  0.0631  0.0631  0.0631  0.0631
    #=Information    =#       0.0567    0.0583  0.0599  0.0614  0.0628  0.0643  0.0658  0.0672  0.0687  0.0702  0.0702  0.0702  0.0702  0.0702  0.0702  0.0702  0.0702  0.0702  0.0702  0.0702  0.0702  0.0702  0.0702  0.0702  0.0702
    #=Offices        =#       0.0541    0.0539  0.0538  0.0536  0.0534  0.0532  0.0530  0.0527  0.0525  0.0522  0.0522  0.0522  0.0522  0.0522  0.0522  0.0522  0.0522  0.0522  0.0522  0.0522  0.0522  0.0522  0.0522  0.0522  0.0522
    #=Retail         =#       0.0534    0.0528  0.0523  0.0518  0.0513  0.0507  0.0502  0.0496  0.0490  0.0485  0.0485  0.0485  0.0485  0.0485  0.0485  0.0485  0.0485  0.0485  0.0485  0.0485  0.0485  0.0485  0.0485  0.0485  0.0485
    #=Warehouse      =#       0.0591    0.0588  0.0585  0.0581  0.0578  0.0574  0.0569  0.0565  0.0560  0.0556  0.0556  0.0556  0.0556  0.0556  0.0556  0.0556  0.0556  0.0556  0.0556  0.0556  0.0556  0.0556  0.0556  0.0556  0.0556
    #=Wholesale      =#       0.0559    0.0554  0.0548  0.0543  0.0537  0.0531  0.0525  0.0520  0.0514  0.0508  0.0508  0.0508  0.0508  0.0508  0.0508  0.0508  0.0508  0.0508  0.0508  0.0508  0.0508  0.0508  0.0508  0.0508  0.0508
    ]

  area = Select(Area,"NL")
  Reduce[eccs,poll,area,years] .= [
    #/Hg                        2026      2027    2028    2029    2030    2031    2032    2033    2034    2035    2036    2037    2038    2039    2040    2041    2042    2043    2044    2045    2046    2047    2048    2049    2050 
    #=OtherCommercial=#       0.0440    0.0427  0.0414  0.0401  0.0389  0.0376  0.0364  0.0352  0.0340  0.0328  0.0328  0.0328  0.0328  0.0328  0.0328  0.0328  0.0328  0.0328  0.0328  0.0328  0.0328  0.0328  0.0328  0.0328  0.0328
    #=Education      =#       0.0407    0.0396  0.0385  0.0375  0.0366  0.0357  0.0348  0.0339  0.0331  0.0323  0.0323  0.0323  0.0323  0.0323  0.0323  0.0323  0.0323  0.0323  0.0323  0.0323  0.0323  0.0323  0.0323  0.0323  0.0323
    #=Health         =#       0.0420    0.0417  0.0412  0.0407  0.0402  0.0396  0.0390  0.0384  0.0377  0.0371  0.0371  0.0371  0.0371  0.0371  0.0371  0.0371  0.0371  0.0371  0.0371  0.0371  0.0371  0.0371  0.0371  0.0371  0.0371
    #=Information    =#       0.0432    0.0435  0.0438  0.0441  0.0443  0.0446  0.0449  0.0452  0.0455  0.0459  0.0459  0.0459  0.0459  0.0459  0.0459  0.0459  0.0459  0.0459  0.0459  0.0459  0.0459  0.0459  0.0459  0.0459  0.0459
    #=Offices        =#       0.0418    0.0405  0.0391  0.0378  0.0366  0.0354  0.0343  0.0332  0.0321  0.0312  0.0312  0.0312  0.0312  0.0312  0.0312  0.0312  0.0312  0.0312  0.0312  0.0312  0.0312  0.0312  0.0312  0.0312  0.0312
    #=Retail         =#       0.0424    0.0411  0.0396  0.0383  0.0370  0.0357  0.0345  0.0333  0.0321  0.0310  0.0310  0.0310  0.0310  0.0310  0.0310  0.0310  0.0310  0.0310  0.0310  0.0310  0.0310  0.0310  0.0310  0.0310  0.0310
    #=Warehouse      =#       0.0445    0.0443  0.0441  0.0439  0.0439  0.0438  0.0439  0.0440  0.0441  0.0443  0.0443  0.0443  0.0443  0.0443  0.0443  0.0443  0.0443  0.0443  0.0443  0.0443  0.0443  0.0443  0.0443  0.0443  0.0443
    #=Wholesale      =#       0.0457    0.0443  0.0428  0.0414  0.0400  0.0386  0.0372  0.0359  0.0347  0.0335  0.0335  0.0335  0.0335  0.0335  0.0335  0.0335  0.0335  0.0335  0.0335  0.0335  0.0335  0.0335  0.0335  0.0335  0.0335
    ]

  area = Select(Area,"PE")
  Reduce[eccs,poll,area,years] .= [
    #/Hg                        2026      2027    2028    2029    2030    2031    2032    2033    2034    2035    2036    2037    2038    2039    2040    2041    2042    2043    2044    2045    2046    2047    2048    2049    2050 
    #=OtherCommercial=#       0.0513    0.0505  0.0497  0.0490  0.0482  0.0474  0.0465  0.0456  0.0447  0.0439  0.0439  0.0439  0.0439  0.0439  0.0439  0.0439  0.0439  0.0439  0.0439  0.0439  0.0439  0.0439  0.0439  0.0439  0.0439
    #=Education      =#       0.0527    0.0524  0.0522  0.0519  0.0515  0.0510  0.0505  0.0500  0.0494  0.0489  0.0489  0.0489  0.0489  0.0489  0.0489  0.0489  0.0489  0.0489  0.0489  0.0489  0.0489  0.0489  0.0489  0.0489  0.0489
    #=Health         =#       0.0554    0.0560  0.0565  0.0570  0.0574  0.0577  0.0580  0.0582  0.0584  0.0586  0.0586  0.0586  0.0586  0.0586  0.0586  0.0586  0.0586  0.0586  0.0586  0.0586  0.0586  0.0586  0.0586  0.0586  0.0586
    #=Information    =#       0.0604    0.0618  0.0632  0.0647  0.0661  0.0676  0.0690  0.0705  0.0720  0.0734  0.0734  0.0734  0.0734  0.0734  0.0734  0.0734  0.0734  0.0734  0.0734  0.0734  0.0734  0.0734  0.0734  0.0734  0.0734
    #=Offices        =#       0.0545    0.0538  0.0531  0.0525  0.0517  0.0510  0.0502  0.0494  0.0487  0.0479  0.0479  0.0479  0.0479  0.0479  0.0479  0.0479  0.0479  0.0479  0.0479  0.0479  0.0479  0.0479  0.0479  0.0479  0.0479
    #=Retail         =#       0.0539    0.0528  0.0518  0.0507  0.0497  0.0487  0.0476  0.0466  0.0456  0.0446  0.0446  0.0446  0.0446  0.0446  0.0446  0.0446  0.0446  0.0446  0.0446  0.0446  0.0446  0.0446  0.0446  0.0446  0.0446
    #=Warehouse      =#       0.0625    0.0620  0.0614  0.0608  0.0602  0.0596  0.0588  0.0581  0.0573  0.0566  0.0566  0.0566  0.0566  0.0566  0.0566  0.0566  0.0566  0.0566  0.0566  0.0566  0.0566  0.0566  0.0566  0.0566  0.0566
    #=Wholesale      =#       0.0607    0.0595  0.0583  0.0571  0.0560  0.0548  0.0536  0.0525  0.0514  0.0503  0.0503  0.0503  0.0503  0.0503  0.0503  0.0503  0.0503  0.0503  0.0503  0.0503  0.0503  0.0503  0.0503  0.0503  0.0503
    ]

  area = Select(Area,"YT")
  Reduce[eccs,poll,area,years] .= [
    #/Hg                        2026      2027    2028    2029    2030    2031    2032    2033    2034    2035    2036    2037    2038    2039    2040    2041    2042    2043    2044    2045    2046    2047    2048    2049    2050 
    #=OtherCommercial=#       0.0488    0.0470  0.0453  0.0436  0.0418  0.0402  0.0387  0.0373  0.0359  0.0347  0.0347  0.0347  0.0347  0.0347  0.0347  0.0347  0.0347  0.0347  0.0347  0.0347  0.0347  0.0347  0.0347  0.0347  0.0347
    #=Education      =#       0.0449    0.0437  0.0425  0.0412  0.0399  0.0386  0.0373  0.0361  0.0350  0.0339  0.0339  0.0339  0.0339  0.0339  0.0339  0.0339  0.0339  0.0339  0.0339  0.0339  0.0339  0.0339  0.0339  0.0339  0.0339
    #=Health         =#       0.0463    0.0462  0.0461  0.0459  0.0457  0.0454  0.0452  0.0449  0.0446  0.0442  0.0442  0.0442  0.0442  0.0442  0.0442  0.0442  0.0442  0.0442  0.0442  0.0442  0.0442  0.0442  0.0442  0.0442  0.0442
    #=Information    =#       0.0493    0.0484  0.0476  0.0466  0.0453  0.0439  0.0428  0.0417  0.0405  0.0395  0.0395  0.0395  0.0395  0.0395  0.0395  0.0395  0.0395  0.0395  0.0395  0.0395  0.0395  0.0395  0.0395  0.0395  0.0395
    #=Offices        =#       0.0493    0.0476  0.0458  0.0439  0.0421  0.0405  0.0391  0.0378  0.0366  0.0354  0.0354  0.0354  0.0354  0.0354  0.0354  0.0354  0.0354  0.0354  0.0354  0.0354  0.0354  0.0354  0.0354  0.0354  0.0354
    #=Retail         =#       0.0484    0.0466  0.0447  0.0428  0.0410  0.0394  0.0380  0.0367  0.0355  0.0343  0.0343  0.0343  0.0343  0.0343  0.0343  0.0343  0.0343  0.0343  0.0343  0.0343  0.0343  0.0343  0.0343  0.0343  0.0343
    #=Warehouse      =#       0.0581    0.0608  0.0639  0.0672  0.0701  0.0737  0.0777  0.0820  0.0866  0.0916  0.0916  0.0916  0.0916  0.0916  0.0916  0.0916  0.0916  0.0916  0.0916  0.0916  0.0916  0.0916  0.0916  0.0916  0.0916
    #=Wholesale      =#       0.0492    0.0473  0.0454  0.0435  0.0416  0.0400  0.0386  0.0373  0.0360  0.0349  0.0349  0.0349  0.0349  0.0349  0.0349  0.0349  0.0349  0.0349  0.0349  0.0349  0.0349  0.0349  0.0349  0.0349  0.0349
    ]

  area = Select(Area,"NT")
  Reduce[eccs,poll,area,years] .= [
    #/Hg                        2026      2027    2028    2029    2030    2031    2032    2033    2034    2035    2036    2037    2038    2039    2040    2041    2042    2043    2044    2045    2046    2047    2048    2049    2050 
    #=OtherCommercial=#       0.0517    0.0502  0.0485  0.0471  0.0458  0.0447  0.0437  0.0427  0.0418  0.0410  0.0410  0.0410  0.0410  0.0410  0.0410  0.0410  0.0410  0.0410  0.0410  0.0410  0.0410  0.0410  0.0410  0.0410  0.0410
    #=Education      =#       0.0447    0.0439  0.0429  0.0420  0.0412  0.0405  0.0398  0.0391  0.0384  0.0378  0.0378  0.0378  0.0378  0.0378  0.0378  0.0378  0.0378  0.0378  0.0378  0.0378  0.0378  0.0378  0.0378  0.0378  0.0378
    #=Health         =#       0.0453    0.0450  0.0446  0.0443  0.0440  0.0437  0.0435  0.0432  0.0430  0.0427  0.0427  0.0427  0.0427  0.0427  0.0427  0.0427  0.0427  0.0427  0.0427  0.0427  0.0427  0.0427  0.0427  0.0427  0.0427
    #=Information    =#       0.0514    0.0513  0.0509  0.0506  0.0508  0.0504  0.0500  0.0494  0.0489  0.0482  0.0482  0.0482  0.0482  0.0482  0.0482  0.0482  0.0482  0.0482  0.0482  0.0482  0.0482  0.0482  0.0482  0.0482  0.0482
    #=Offices        =#       0.0480    0.0471  0.0459  0.0449  0.0441  0.0433  0.0426  0.0419  0.0413  0.0406  0.0406  0.0406  0.0406  0.0406  0.0406  0.0406  0.0406  0.0406  0.0406  0.0406  0.0406  0.0406  0.0406  0.0406  0.0406
    #=Retail         =#       0.0502    0.0493  0.0480  0.0469  0.0461  0.0453  0.0447  0.0440  0.0433  0.0426  0.0426  0.0426  0.0426  0.0426  0.0426  0.0426  0.0426  0.0426  0.0426  0.0426  0.0426  0.0426  0.0426  0.0426  0.0426
    #=Warehouse      =#       0.0772    0.0742  0.0700  0.0667  0.0609  0.0569  0.0541  0.0521  0.0507  0.0495  0.0495  0.0495  0.0495  0.0495  0.0495  0.0495  0.0495  0.0495  0.0495  0.0495  0.0495  0.0495  0.0495  0.0495  0.0495
    #=Wholesale      =#       0.0869    0.0853  0.0830  0.0812  0.0797  0.0785  0.0773  0.0761  0.0749  0.0738  0.0738  0.0738  0.0738  0.0738  0.0738  0.0738  0.0738  0.0738  0.0738  0.0738  0.0738  0.0738  0.0738  0.0738  0.0738
    ]

  area = Select(Area,"NU")
  Reduce[eccs,poll,area,years] .= [
    #/Hg                        2026      2027    2028    2029    2030    2031    2032    2033    2034    2035    2036    2037    2038    2039    2040    2041    2042    2043    2044    2045    2046    2047    2048    2049    2050 
    #=OtherCommercial=#       0.0383    0.0370  0.0358  0.0347  0.0337  0.0327  0.0318  0.0310  0.0302  0.0294  0.0294  0.0294  0.0294  0.0294  0.0294  0.0294  0.0294  0.0294  0.0294  0.0294  0.0294  0.0294  0.0294  0.0294  0.0294
    #=Education      =#       0.0413    0.0402  0.0391  0.0381  0.0371  0.0362  0.0353  0.0345  0.0337  0.0329  0.0329  0.0329  0.0329  0.0329  0.0329  0.0329  0.0329  0.0329  0.0329  0.0329  0.0329  0.0329  0.0329  0.0329  0.0329
    #=Health         =#       0.0390    0.0384  0.0379  0.0374  0.0369  0.0363  0.0359  0.0354  0.0349  0.0344  0.0344  0.0344  0.0344  0.0344  0.0344  0.0344  0.0344  0.0344  0.0344  0.0344  0.0344  0.0344  0.0344  0.0344  0.0344
    #=Information    =#       0.0443    0.0441  0.0437  0.0434  0.0433  0.0428  0.0426  0.0422  0.0419  0.0416  0.0416  0.0416  0.0416  0.0416  0.0416  0.0416  0.0416  0.0416  0.0416  0.0416  0.0416  0.0416  0.0416  0.0416  0.0416
    #=Offices        =#       0.0435    0.0423  0.0411  0.0400  0.0390  0.0381  0.0372  0.0364  0.0356  0.0349  0.0349  0.0349  0.0349  0.0349  0.0349  0.0349  0.0349  0.0349  0.0349  0.0349  0.0349  0.0349  0.0349  0.0349  0.0349
    #=Retail         =#       0.0459    0.0445  0.0433  0.0422  0.0411  0.0401  0.0392  0.0384  0.0375  0.0367  0.0367  0.0367  0.0367  0.0367  0.0367  0.0367  0.0367  0.0367  0.0367  0.0367  0.0367  0.0367  0.0367  0.0367  0.0367
    #=Warehouse      =#       0.0532    0.0535  0.0537  0.0538  0.0538  0.0538  0.0536  0.0533  0.0530  0.0526  0.0526  0.0526  0.0526  0.0526  0.0526  0.0526  0.0526  0.0526  0.0526  0.0526  0.0526  0.0526  0.0526  0.0526  0.0526
    #=Wholesale      =#       0.0468    0.0453  0.0441  0.0429  0.0419  0.0409  0.0400  0.0391  0.0382  0.0374  0.0374  0.0374  0.0374  0.0374  0.0374  0.0374  0.0374  0.0374  0.0374  0.0374  0.0374  0.0374  0.0374  0.0374  0.0374
    ]

  #
  # Apply reductions to coefficient
  #
  nation = Select(Nation,"CN")
  areas = findall(ANMap[:,nation] .== 1.0)
  for ecc in eccs, area in areas, year in years
    MEPOCX[ecc,poll,area,year] = MEPOCX[ecc,poll,area,year]*(1-Reduce[ecc,poll,area,year])
  end

  WriteDisk(db,"MEInput/MEPOCX",MEPOCX)
  
end


function PolicyControl(db)
  @info "CAC_Hg_Products.jl - PolicyControl"
  MacroPolicy(db)
end

if abspath(PROGRAM_FILE) == @__FILE__
  PolicyControl(DB)
end

end

#
# CAC_VOC_Products.jl - This jl models the VOC in certain products (SOR/2021-268) Regulations
#
#
# Reductions estimates calculations available in this file:
# VOCinCertainProducts_ReductionEstimates.xlsx
#

using SmallModel

module CAC_VOC_Products

import ...SmallModel: ReadDisk,WriteDisk,Select
import ...SmallModel: HisTime,ITime,MaxTime,First,Future,Final,Yr
import ...SmallModel: @finite_math,finite_inverse,finite_divide,finite_power,finite_exp,finite_log
import ...SmallModel: DB

const VariableArray{N} = Array{Float64,N} where {N}
const SetArray = Vector{String}

Base.@kwdef struct RControl
  db::String

  CalDB::String = "RCalDB"
  Input::String = "RInput"
  Outpt::String = "ROutput"
  BCNameDB::String = ReadDisk(db,"E2020DB/BCNameDB") #  Base Case Name

  Area::SetArray = ReadDisk(db,"E2020DB/AreaKey")
  AreaDS::SetArray = ReadDisk(db,"E2020DB/AreaDS")
  Areas::Vector{Int} = collect(Select(Area))
  ECC::SetArray = ReadDisk(db,"E2020DB/ECCKey")
  ECCDS::SetArray = ReadDisk(db,"E2020DB/ECCDS")
  ECCs::Vector{Int} = collect(Select(ECC))
  Nation::SetArray = ReadDisk(db,"E2020DB/NationKey")
  NationDS::SetArray = ReadDisk(db,"E2020DB/NationDS")
  Nations::Vector{Int} = collect(Select(Nation))
  Poll::SetArray = ReadDisk(db,"E2020DB/PollKey")
  PollDS::SetArray = ReadDisk(db,"E2020DB/PollDS")
  Polls::Vector{Int} = collect(Select(Poll))
  Year::SetArray = ReadDisk(db,"E2020DB/YearKey")
  YearDS::SetArray = ReadDisk(db,"E2020DB/YearDS")
  Years::Vector{Int} = collect(Select(Year))

  ANMap::VariableArray{2} = ReadDisk(db,"E2020DB/ANMap") # [Area,Nation] Map between Area and Nation
  MEPOCX::VariableArray{4} = ReadDisk(db,"MEInput/MEPOCX") # [ECC,Poll,Area,Year] Non-Energy Pollution Coefficient (Tonnes/Economic Driver)

  # Scratch Variables
  Reduce::VariableArray{4} = zeros(Float64,length(ECC),length(Poll),length(Area),length(Year)) # [ECC,Poll,Area,Year] Scratch Variable For Input Reductions
end

function ResPolicy(db)
  data = RControl(; db)
  (; Area,ECC,Nation) = data
  (; Poll) = data
  (; ANMap,MEPOCX,Reduce) = data

  #
  # Read in reductions to marginal coefficient calculated by Environment Canada.
  #
  ################
  poll = Select(Poll,"VOC")
  years = collect(Yr(2023):Yr(2050))
  eccs = Select(ECC,["SingleFamily","MultiFamily","OtherResidential"])
  #
  area = Select(Area,"AB")
  #! format: off
  Reduce[eccs, poll, area, years] .= [
    # 2023      2024    2025    2026    2027    2028    2029    2030    2031    2032    2033    2034    2035    2036    2037    2038    2039    2040    2041    2042    2043    2044    2045    2046    2047    2048    2049    2050 #   /VOC
    0.1863    0.1812  0.1768  0.1732  0.1697  0.1664  0.1631  0.1598  0.1567  0.1535  0.1504  0.1473  0.1443  0.1443  0.1443  0.1443  0.1443  0.1443  0.1443  0.1443  0.1443  0.1443  0.1443  0.1443  0.1443  0.1443  0.1443  0.1443 #  SingleFamily
    0.1800    0.1739  0.1682  0.1637  0.1595  0.1556  0.1519  0.1483  0.1447  0.1412  0.1378  0.1344  0.1312  0.1312  0.1312  0.1312  0.1312  0.1312  0.1312  0.1312  0.1312  0.1312  0.1312  0.1312  0.1312  0.1312  0.1312  0.1312 #   MultiFamily
    0.1907    0.1888  0.1819  0.1782  0.1771  0.1760  0.1760  0.1753  0.1721  0.1674  0.1630  0.1580  0.1541  0.1541  0.1541  0.1541  0.1541  0.1541  0.1541  0.1541  0.1541  0.1541  0.1541  0.1541  0.1541  0.1541  0.1541  0.1541 #   OtherResidential
  ]
  #! format: on

  area = Select(Area,"BC")
  #! format: off
  Reduce[eccs, poll, area, years] .= [
    # 2023      2024    2025    2026    2027    2028    2029    2030    2031    2032    2033    2034    2035    2036    2037    2038    2039    2040    2041    2042    2043    2044    2045    2046    2047    2048    2049    2050 #   /VOC
    0.2127    0.2077  0.2038  0.2007  0.1976  0.1952  0.1929  0.1907  0.1881  0.1861  0.1842  0.1823  0.1803  0.1803  0.1803  0.1803  0.1803  0.1803  0.1803  0.1803  0.1803  0.1803  0.1803  0.1803  0.1803  0.1803  0.1803  0.1803 #  SingleFamily
    0.2052    0.1984  0.1925  0.1875  0.1824  0.1780  0.1739  0.1700  0.1658  0.1625  0.1593  0.1561  0.1530  0.1530  0.1530  0.1530  0.1530  0.1530  0.1530  0.1530  0.1530  0.1530  0.1530  0.1530  0.1530  0.1530  0.1530  0.1530 #   MultiFamily
    0.2100    0.2118  0.2131  0.2136  0.2138  0.2137  0.2136  0.2129  0.2117  0.2102  0.2086  0.2068  0.2045  0.2045  0.2045  0.2045  0.2045  0.2045  0.2045  0.2045  0.2045  0.2045  0.2045  0.2045  0.2045  0.2045  0.2045  0.2045 #   OtherResidential
  ]
  #! format: on

  area = Select(Area,"SK")
  #! format: off
  Reduce[eccs, poll, area, years] .= [
    # 2023      2024    2025    2026    2027    2028    2029    2030    2031    2032    2033    2034    2035    2036    2037    2038    2039    2040    2041    2042    2043    2044    2045    2046    2047    2048    2049    2050 #   /VOC
    0.1827    0.1804  0.1780  0.1755  0.1729  0.1710  0.1692  0.1673  0.1654  0.1635  0.1616  0.1597  0.1576  0.1576  0.1576  0.1576  0.1576  0.1576  0.1576  0.1576  0.1576  0.1576  0.1576  0.1576  0.1576  0.1576  0.1576  0.1576 #  SingleFamily
    0.1779    0.1738  0.1696  0.1658  0.1621  0.1591  0.1562  0.1533  0.1505  0.1474  0.1445  0.1416  0.1388  0.1388  0.1388  0.1388  0.1388  0.1388  0.1388  0.1388  0.1388  0.1388  0.1388  0.1388  0.1388  0.1388  0.1388  0.1388 #   MultiFamily
    0.2111    0.1955  0.1791  0.1721  0.1679  0.1643  0.1627  0.1604  0.1546  0.1497  0.1452  0.1394  0.1361  0.1361  0.1361  0.1361  0.1361  0.1361  0.1361  0.1361  0.1361  0.1361  0.1361  0.1361  0.1361  0.1361  0.1361  0.1361 #   OtherResidential
  ]
  #! format: on

  area = Select(Area,"MB")
  #! format: off
  Reduce[eccs, poll, area, years] .= [
    # 2023      2024    2025    2026    2027    2028    2029    2030    2031    2032    2033    2034    2035    2036    2037    2038    2039    2040    2041    2042    2043    2044    2045    2046    2047    2048    2049    2050 #   /VOC
    0.1793    0.1776  0.1760  0.1742  0.1722  0.1703  0.1683  0.1663  0.1645  0.1629  0.1611  0.1594  0.1576  0.1576  0.1576  0.1576  0.1576  0.1576  0.1576  0.1576  0.1576  0.1576  0.1576  0.1576  0.1576  0.1576  0.1576  0.1576 #  SingleFamily
    0.1776    0.1744  0.1713  0.1681  0.1649  0.1617  0.1587  0.1555  0.1525  0.1497  0.1467  0.1438  0.1409  0.1409  0.1409  0.1409  0.1409  0.1409  0.1409  0.1409  0.1409  0.1409  0.1409  0.1409  0.1409  0.1409  0.1409  0.1409 #   MultiFamily
    0.2346    0.2113  0.1871  0.1737  0.1639  0.1543  0.1473  0.1412  0.1318  0.1215  0.1126  0.1045  0.0979  0.0979  0.0979  0.0979  0.0979  0.0979  0.0979  0.0979  0.0979  0.0979  0.0979  0.0979  0.0979  0.0979  0.0979  0.0979 #   OtherResidential
  ]
  #! format: on

  area = Select(Area,"ON")
  #! format: off
  Reduce[eccs, poll, area, years] .= [
    # 2023      2024    2025    2026    2027    2028    2029    2030    2031    2032    2033    2034    2035    2036    2037    2038    2039    2040    2041    2042    2043    2044    2045    2046    2047    2048    2049    2050 #   /VOC
    0.1672    0.1660  0.1643  0.1619  0.1600  0.1579  0.1559  0.1538  0.1518  0.1498  0.1478  0.1457  0.1437  0.1437  0.1437  0.1437  0.1437  0.1437  0.1437  0.1437  0.1437  0.1437  0.1437  0.1437  0.1437  0.1437  0.1437  0.1437 #  SingleFamily
    0.1667    0.1611  0.1566  0.1531  0.1502  0.1471  0.1441  0.1411  0.1382  0.1354  0.1327  0.1300  0.1273  0.1273  0.1273  0.1273  0.1273  0.1273  0.1273  0.1273  0.1273  0.1273  0.1273  0.1273  0.1273  0.1273  0.1273  0.1273 #   MultiFamily
    0.2272    0.2356  0.2192  0.2054  0.2006  0.1922  0.1903  0.1870  0.1725  0.1552  0.1402  0.1257  0.1157  0.1157  0.1157  0.1157  0.1157  0.1157  0.1157  0.1157  0.1157  0.1157  0.1157  0.1157  0.1157  0.1157  0.1157  0.1157 #   OtherResidential
  ]
  #! format: on

  area = Select(Area,"QC")
  #! format: off
  Reduce[eccs, poll, area, years] .= [
    # 2023      2024    2025    2026    2027    2028    2029    2030    2031    2032    2033    2034    2035    2036    2037    2038    2039    2040    2041    2042    2043    2044    2045    2046    2047    2048    2049    2050 #   /VOC
    0.1831    0.1821  0.1814  0.1809  0.1805  0.1799  0.1794  0.1788  0.1784  0.1780  0.1776  0.1772  0.1768  0.1768  0.1768  0.1768  0.1768  0.1768  0.1768  0.1768  0.1768  0.1768  0.1768  0.1768  0.1768  0.1768  0.1768  0.1768 #  SingleFamily
    0.1829    0.1805  0.1783  0.1762  0.1744  0.1725  0.1707  0.1689  0.1673  0.1658  0.1643  0.1630  0.1616  0.1616  0.1616  0.1616  0.1616  0.1616  0.1616  0.1616  0.1616  0.1616  0.1616  0.1616  0.1616  0.1616  0.1616  0.1616 #   MultiFamily
    0.2253    0.2119  0.1959  0.1850  0.1789  0.1728  0.1694  0.1664  0.1605  0.1543  0.1491  0.1442  0.1413  0.1413  0.1413  0.1413  0.1413  0.1413  0.1413  0.1413  0.1413  0.1413  0.1413  0.1413  0.1413  0.1413  0.1413  0.1413 #   OtherResidential
  ]
  #! format: on

  area = Select(Area,"NB")
  #! format: off
  Reduce[eccs, poll, area, years] .= [
    # 2023      2024    2025    2026    2027    2028    2029    2030    2031    2032    2033    2034    2035    2036    2037    2038    2039    2040    2041    2042    2043    2044    2045    2046    2047    2048    2049    2050 #   /VOC
    0.1820    0.1803  0.1789  0.1772  0.1755  0.1738  0.1718  0.1699  0.1686  0.1673  0.1660  0.1647  0.1632  0.1632  0.1632  0.1632  0.1632  0.1632  0.1632  0.1632  0.1632  0.1632  0.1632  0.1632  0.1632  0.1632  0.1632  0.1632 #  SingleFamily
    0.1793    0.1754  0.1714  0.1676  0.1639  0.1602  0.1565  0.1528  0.1496  0.1466  0.1436  0.1407  0.1378  0.1378  0.1378  0.1378  0.1378  0.1378  0.1378  0.1378  0.1378  0.1378  0.1378  0.1378  0.1378  0.1378  0.1378  0.1378 #   MultiFamily
    0.2011    0.1930  0.1838  0.1770  0.1726  0.1677  0.1665  0.1631  0.1571  0.1510  0.1454  0.1393  0.1356  0.1356  0.1356  0.1356  0.1356  0.1356  0.1356  0.1356  0.1356  0.1356  0.1356  0.1356  0.1356  0.1356  0.1356  0.1356 #   OtherResidential
  ]
  #! format: on

  area = Select(Area,"NS")
  #! format: off
  Reduce[eccs, poll, area, years] .= [
    # 2023      2024    2025    2026    2027    2028    2029    2030    2031    2032    2033    2034    2035    2036    2037    2038    2039    2040    2041    2042    2043    2044    2045    2046    2047    2048    2049    2050 #   /VOC
    0.1745    0.1720  0.1721  0.1705  0.1686  0.1668  0.1646  0.1625  0.1611  0.1596  0.1580  0.1564  0.1545  0.1545  0.1545  0.1545  0.1545  0.1545  0.1545  0.1545  0.1545  0.1545  0.1545  0.1545  0.1545  0.1545  0.1545  0.1545 #  SingleFamily
    0.1718    0.1681  0.1666  0.1635  0.1603  0.1572  0.1542  0.1513  0.1488  0.1462  0.1436  0.1411  0.1386  0.1386  0.1386  0.1386  0.1386  0.1386  0.1386  0.1386  0.1386  0.1386  0.1386  0.1386  0.1386  0.1386  0.1386  0.1386 #   MultiFamily
    0.2131    0.2060  0.1955  0.1834  0.1732  0.1634  0.1575  0.1489  0.1397  0.1316  0.1238  0.1168  0.1118  0.1118  0.1118  0.1118  0.1118  0.1118  0.1118  0.1118  0.1118  0.1118  0.1118  0.1118  0.1118  0.1118  0.1118  0.1118 #   OtherResidential
  ]
  #! format: on

  area = Select(Area,"NL")
  #! format: off
  Reduce[eccs, poll, area, years] .= [
    # 2023      2024    2025    2026    2027    2028    2029    2030    2031    2032    2033    2034    2035    2036    2037    2038    2039    2040    2041    2042    2043    2044    2045    2046    2047    2048    2049    2050 #   /VOC
    0.1678    0.1683  0.1683  0.1684  0.1679  0.1672  0.1662  0.1652  0.1643  0.1634  0.1626  0.1619  0.1616  0.1616  0.1616  0.1616  0.1616  0.1616  0.1616  0.1616  0.1616  0.1616  0.1616  0.1616  0.1616  0.1616  0.1616  0.1616 #  SingleFamily
    0.1671    0.1678  0.1681  0.1684  0.1682  0.1675  0.1664  0.1657  0.1650  0.1641  0.1637  0.1631  0.1631  0.1631  0.1631  0.1631  0.1631  0.1631  0.1631  0.1631  0.1631  0.1631  0.1631  0.1631  0.1631  0.1631  0.1631  0.1631 #   MultiFamily
    0.1656    0.1769  0.1769  0.1777  0.1798  0.1818  0.1852  0.1879  0.1889  0.1895  0.1900  0.1896  0.1907  0.1907  0.1907  0.1907  0.1907  0.1907  0.1907  0.1907  0.1907  0.1907  0.1907  0.1907  0.1907  0.1907  0.1907  0.1907 #   OtherResidential
  ]
  #! format: on

  area = Select(Area,"PE")
  #! format: off
  Reduce[eccs, poll, area, years] .= [
    # 2023      2024    2025    2026    2027    2028    2029    2030    2031    2032    2033    2034    2035    2036    2037    2038    2039    2040    2041    2042    2043    2044    2045    2046    2047    2048    2049    2050 #   /VOC
    0.1659    0.1631  0.1614  0.1591  0.1573  0.1553  0.1535  0.1510  0.1488  0.1467  0.1443  0.1422  0.1396  0.1396  0.1396  0.1396  0.1396  0.1396  0.1396  0.1396  0.1396  0.1396  0.1396  0.1396  0.1396  0.1396  0.1396  0.1396 #  SingleFamily
    0.1627    0.1589  0.1552  0.1508  0.1477  0.1438  0.1409  0.1374  0.1341  0.1302  0.1272  0.1244  0.1211  0.1211  0.1211  0.1211  0.1211  0.1211  0.1211  0.1211  0.1211  0.1211  0.1211  0.1211  0.1211  0.1211  0.1211  0.1211 #   MultiFamily
    0.1844    0.1878  0.1763  0.1707  0.1618  0.1529  0.1475  0.1453  0.1366  0.1286  0.1218  0.1150  0.1109  0.1109  0.1109  0.1109  0.1109  0.1109  0.1109  0.1109  0.1109  0.1109  0.1109  0.1109  0.1109  0.1109  0.1109  0.1109 #   OtherResidential
  ]
  #! format: on

  area = Select(Area,"YT")
  #! format: off
  Reduce[eccs, poll, area, years] .= [
    # 2023      2024    2025    2026    2027    2028    2029    2030    2031    2032    2033    2034    2035    2036    2037    2038    2039    2040    2041    2042    2043    2044    2045    2046    2047    2048    2049    2050 #   /VOC
    0.1300    0.1271  0.1244  0.1215  0.1185  0.1157  0.1131  0.1108  0.1079  0.1051  0.1032  0.1014  0.1001  0.1001  0.1001  0.1001  0.1001  0.1001  0.1001  0.1001  0.1001  0.1001  0.1001  0.1001  0.1001  0.1001  0.1001  0.1001 #  SingleFamily
    0.1246    0.1220  0.1182  0.1149  0.1118  0.1084  0.1054  0.1037  0.1022  0.1007  0.0995  0.0995  0.0993  0.0993  0.0993  0.0993  0.0993  0.0993  0.0993  0.0993  0.0993  0.0993  0.0993  0.0993  0.0993  0.0993  0.0993  0.0993 #   MultiFamily
    0.1502    0.1344  0.1203  0.1123  0.1072  0.1012  0.0971  0.0932  0.0881  0.0828  0.0802  0.0779  0.0766  0.0766  0.0766  0.0766  0.0766  0.0766  0.0766  0.0766  0.0766  0.0766  0.0766  0.0766  0.0766  0.0766  0.0766  0.0766 #   OtherResidential
  ]
  #! format: on

  area = Select(Area,"NT")
  #! format: off
  Reduce[eccs, poll, area, years] .= [
    # 2023      2024    2025    2026    2027    2028    2029    2030    2031    2032    2033    2034    2035    2036    2037    2038    2039    2040    2041    2042    2043    2044    2045    2046    2047    2048    2049    2050 #   /VOC
    0.1189    0.1187  0.1185  0.1178  0.1171  0.1168  0.1164  0.1156  0.1144  0.1136  0.1123  0.1107  0.1092  0.1092  0.1092  0.1092  0.1092  0.1092  0.1092  0.1092  0.1092  0.1092  0.1092  0.1092  0.1092  0.1092  0.1092  0.1092 #  SingleFamily
    0.1138    0.1138  0.1125  0.1114  0.1104  0.1093  0.1083  0.1080  0.1083  0.1086  0.1083  0.1085  0.1082  0.1082  0.1082  0.1082  0.1082  0.1082  0.1082  0.1082  0.1082  0.1082  0.1082  0.1082  0.1082  0.1082  0.1082  0.1082 #   MultiFamily
    0.1370    0.1252  0.1143  0.1086  0.1057  0.1019  0.0996  0.0970  0.0932  0.0892  0.0871  0.0848  0.0833  0.0833  0.0833  0.0833  0.0833  0.0833  0.0833  0.0833  0.0833  0.0833  0.0833  0.0833  0.0833  0.0833  0.0833  0.0833 #   OtherResidential
  ]
  #! format: on

  area = Select(Area,"NU")
  #! format: off
  Reduce[eccs, poll, area, years] .= [
    # 2023      2024    2025    2026    2027    2028    2029    2030    2031    2032    2033    2034    2035    2036    2037    2038    2039    2040    2041    2042    2043    2044    2045    2046    2047    2048    2049    2050 #   /VOC
    0.1374    0.1360  0.1346  0.1327  0.1308  0.1293  0.1277  0.1258  0.1235  0.1215  0.1191  0.1164  0.1137  0.1137  0.1137  0.1137  0.1137  0.1137  0.1137  0.1137  0.1137  0.1137  0.1137  0.1137  0.1137  0.1137  0.1137  0.1137 #  SingleFamily
    0.1316    0.1304  0.1278  0.1255  0.1233  0.1211  0.1189  0.1176  0.1169  0.1162  0.1148  0.1141  0.1127  0.1127  0.1127  0.1127  0.1127  0.1127  0.1127  0.1127  0.1127  0.1127  0.1127  0.1127  0.1127  0.1127  0.1127  0.1127 #   MultiFamily
    0.1585    0.1435  0.1300  0.1224  0.1182  0.1130  0.1094  0.1056  0.1007  0.0955  0.0924  0.0892  0.0868  0.0868  0.0868  0.0868  0.0868  0.0868  0.0868  0.0868  0.0868  0.0868  0.0868  0.0868  0.0868  0.0868  0.0868  0.0868 #   OtherResidential
  ]
  #! format: on

  #
  # Apply reductions to coefficient
  #
  CN = Select(Nation,"CN")
  areas = findall(ANMap[:,CN] .== 1)

  for year in years, area in areas, ecc in eccs
    MEPOCX[ecc,poll,area,year] = MEPOCX[ecc,poll,area,year]*
      (1-Reduce[ecc,poll,area,year])
  end

  WriteDisk(db,"MEInput/MEPOCX",MEPOCX)
end

Base.@kwdef struct CControl
  db::String

  CalDB::String = "CCalDB"
  Input::String = "CInput"
  Outpt::String = "COutput"
  BCNameDB::String = ReadDisk(db,"E2020DB/BCNameDB") #  Base Case Name

  Area::SetArray = ReadDisk(db,"E2020DB/AreaKey")
  AreaDS::SetArray = ReadDisk(db,"E2020DB/AreaDS")
  Areas::Vector{Int} = collect(Select(Area))
  ECC::SetArray = ReadDisk(db,"E2020DB/ECCKey")
  ECCDS::SetArray = ReadDisk(db,"E2020DB/ECCDS")
  ECCs::Vector{Int} = collect(Select(ECC))
  Nation::SetArray = ReadDisk(db,"E2020DB/NationKey")
  NationDS::SetArray = ReadDisk(db,"E2020DB/NationDS")
  Nations::Vector{Int} = collect(Select(Nation))
  Poll::SetArray = ReadDisk(db,"E2020DB/PollKey")
  PollDS::SetArray = ReadDisk(db,"E2020DB/PollDS")
  Polls::Vector{Int} = collect(Select(Poll))
  Year::SetArray = ReadDisk(db,"E2020DB/YearKey")
  YearDS::SetArray = ReadDisk(db,"E2020DB/YearDS")
  Years::Vector{Int} = collect(Select(Year))

  ANMap::VariableArray{2} = ReadDisk(db,"E2020DB/ANMap") # [Area,Nation] Map between Area and Nation
  MEPOCX::VariableArray{4} = ReadDisk(db,"MEInput/MEPOCX") # [ECC,Poll,Area,Year] Non-Energy Pollution Coefficient (Tonnes/Economic Driver)

  # Scratch Variables
  Reduce::VariableArray{4} = zeros(Float64,length(ECC),length(Poll),length(Area),length(Year)) # [ECC,Poll,Area,Year] Scratch Variable For Input Reductions
end

function ComPolicy(db)
  data = CControl(; db)
  (; Area,ECC,Nation) = data
  (; Poll) = data
  (; ANMap,MEPOCX,Reduce) = data

  #
  # Read in reductions to marginal coefficient calculated by Environment Canada.
  #
  poll = Select(Poll,"VOC")
  years = collect(Yr(2023):Yr(2050))
  eccs = Select(ECC,["OtherCommercial","Education","Health","Information","Offices","Retail","Warehouse","Wholesale"])
  #
  area=Select(Area,"AB")
  #! format: off
  Reduce[eccs, poll, area, years] .= [
    # 2023      2024    2025    2026    2027    2028    2029    2030    2031    2032    2033    2034    2035    2036    2037    2038    2039    2040    2041    2042    2043    2044    2045    2046    2047    2048    2049    2050 # /VOC
    0.1712    0.1715  0.1717  0.1719  0.1720  0.1720  0.1719  0.1716  0.1713  0.1708  0.1702  0.1695  0.1686  0.1755  0.1755  0.1755  0.1755  0.1755  0.1755  0.1755  0.1755  0.1755  0.1755  0.1755  0.1755  0.1755  0.1755  0.1755 # OtherCommercial
    0.1736    0.1706  0.1677  0.1649  0.1622  0.1595  0.1567  0.1540  0.1512  0.1484  0.1457  0.1429  0.1401  0.1553  0.1553  0.1553  0.1553  0.1553  0.1553  0.1553  0.1553  0.1553  0.1553  0.1553  0.1553  0.1553  0.1553  0.1553 # Education
    0.1999    0.1968  0.1939  0.1910  0.1883  0.1854  0.1825  0.1796  0.1767  0.1737  0.1706  0.1676  0.1645  0.1574  0.1574  0.1574  0.1574  0.1574  0.1574  0.1574  0.1574  0.1574  0.1574  0.1574  0.1574  0.1574  0.1574  0.1574 # Health
    0.1803    0.1785  0.1767  0.1749  0.1731  0.1713  0.1694  0.1675  0.1654  0.1634  0.1612  0.1591  0.1569  0.1624  0.1624  0.1624  0.1624  0.1624  0.1624  0.1624  0.1624  0.1624  0.1624  0.1624  0.1624  0.1624  0.1624  0.1624 # Information
    0.1803    0.1784  0.1765  0.1747  0.1728  0.1709  0.1689  0.1669  0.1647  0.1625  0.1602  0.1579  0.1555  0.1619  0.1619  0.1619  0.1619  0.1619  0.1619  0.1619  0.1619  0.1619  0.1619  0.1619  0.1619  0.1619  0.1619  0.1619 # Offices
    0.1728    0.1746  0.1764  0.1781  0.1798  0.1814  0.1828  0.1842  0.1854  0.1865  0.1875  0.1884  0.1891  0.1878  0.1878  0.1878  0.1878  0.1878  0.1878  0.1878  0.1878  0.1878  0.1878  0.1878  0.1878  0.1878  0.1878  0.1878 # Retail
    0.1832    0.1775  0.1723  0.1675  0.1629  0.1585  0.1542  0.1500  0.1460  0.1420  0.1381  0.1344  0.1307  0.1452  0.1452  0.1452  0.1452  0.1452  0.1452  0.1452  0.1452  0.1452  0.1452  0.1452  0.1452  0.1452  0.1452  0.1452 # Warehouse
    0.1798    0.1817  0.1835  0.1853  0.1871  0.1887  0.1902  0.1917  0.1929  0.1941  0.1951  0.1960  0.1968  0.1878  0.1878  0.1878  0.1878  0.1878  0.1878  0.1878  0.1878  0.1878  0.1878  0.1878  0.1878  0.1878  0.1878  0.1878 # Wholesale
  ]
  #! format: on

  area=Select(Area,"BC")
  #! format: off
  Reduce[eccs, poll, area, years] .= [
    # 2023      2024    2025    2026    2027    2028    2029    2030    2031    2032    2033    2034    2035    2036    2037    2038    2039    2040    2041    2042    2043    2044    2045    2046    2047    2048    2049    2050 #   /VOC
    0.2024    0.2005  0.1984  0.1964  0.1944  0.1923  0.1902  0.1879  0.1856  0.1833  0.1808  0.1784  0.1759  0.1723  0.1723  0.1723  0.1723  0.1723  0.1723  0.1723  0.1723  0.1723  0.1723  0.1723  0.1723  0.1723  0.1723  0.1723 # OtherCommercial
    0.2049    0.1982  0.1917  0.1856  0.1799  0.1743  0.1690  0.1639  0.1589  0.1541  0.1495  0.1450  0.1407  0.1474  0.1474  0.1474  0.1474  0.1474  0.1474  0.1474  0.1474  0.1474  0.1474  0.1474  0.1474  0.1474  0.1474  0.1474 # Education
    0.2241    0.2212  0.2181  0.2152  0.2123  0.2093  0.2063  0.2033  0.2002  0.1970  0.1939  0.1907  0.1875  0.1679  0.1679  0.1679  0.1679  0.1679  0.1679  0.1679  0.1679  0.1679  0.1679  0.1679  0.1679  0.1679  0.1679  0.1679 # Health
    0.2018    0.2026  0.2032  0.2037  0.2042  0.2045  0.2046  0.2046  0.2045  0.2042  0.2037  0.2030  0.2023  0.1894  0.1894  0.1894  0.1894  0.1894  0.1894  0.1894  0.1894  0.1894  0.1894  0.1894  0.1894  0.1894  0.1894  0.1894 # Information
    0.2036    0.1989  0.1943  0.1898  0.1856  0.1814  0.1773  0.1732  0.1692  0.1653  0.1614  0.1576  0.1539  0.1562  0.1562  0.1562  0.1562  0.1562  0.1562  0.1562  0.1562  0.1562  0.1562  0.1562  0.1562  0.1562  0.1562  0.1562 # Offices
    0.1958    0.1965  0.1970  0.1975  0.1980  0.1982  0.1984  0.1984  0.1983  0.1981  0.1977  0.1971  0.1965  0.1908  0.1908  0.1908  0.1908  0.1908  0.1908  0.1908  0.1908  0.1908  0.1908  0.1908  0.1908  0.1908  0.1908  0.1908 # Retail
    0.2012    0.2004  0.1994  0.1983  0.1971  0.1958  0.1943  0.1926  0.1907  0.1886  0.1864  0.1841  0.1817  0.1706  0.1706  0.1706  0.1706  0.1706  0.1706  0.1706  0.1706  0.1706  0.1706  0.1706  0.1706  0.1706  0.1706  0.1706 # Warehouse
    0.1981    0.1988  0.1993  0.1998  0.2002  0.2005  0.2007  0.2007  0.2006  0.2004  0.2000  0.1994  0.1988  0.1908  0.1908  0.1908  0.1908  0.1908  0.1908  0.1908  0.1908  0.1908  0.1908  0.1908  0.1908  0.1908  0.1908  0.1908 # Wholesale
  ]
  #! format: on

  area=Select(Area,"SK")
  #! format: off
  Reduce[eccs, poll, area, years] .= [
    # 2023      2024    2025    2026    2027    2028    2029    2030    2031    2032    2033    2034    2035    2036    2037    2038    2039    2040    2041    2042    2043    2044    2045    2046    2047    2048    2049    2050 #   /VOC
    0.1695    0.1687  0.1678  0.1670  0.1661  0.1651  0.1640  0.1629  0.1617  0.1605  0.1593  0.1580  0.1566  0.1796  0.1796  0.1796  0.1796  0.1796  0.1796  0.1796  0.1796  0.1796  0.1796  0.1796  0.1796  0.1796  0.1796  0.1796 # OtherCommercial
    0.1735    0.1704  0.1675  0.1646  0.1619  0.1592  0.1565  0.1539  0.1514  0.1489  0.1464  0.1441  0.1417  0.1667  0.1667  0.1667  0.1667  0.1667  0.1667  0.1667  0.1667  0.1667  0.1667  0.1667  0.1667  0.1667  0.1667  0.1667 # Education
    0.1753    0.1764  0.1775  0.1786  0.1797  0.1806  0.1815  0.1823  0.1830  0.1837  0.1842  0.1847  0.1852  0.1954  0.1954  0.1954  0.1954  0.1954  0.1954  0.1954  0.1954  0.1954  0.1954  0.1954  0.1954  0.1954  0.1954  0.1954 # Health
    0.1715    0.1750  0.1786  0.1821  0.1856  0.1890  0.1923  0.1954  0.1985  0.2015  0.2043  0.2071  0.2097  0.2152  0.2152  0.2152  0.2152  0.2152  0.2152  0.2152  0.2152  0.2152  0.2152  0.2152  0.2152  0.2152  0.2152  0.2152 # Information
    0.1787    0.1728  0.1675  0.1625  0.1578  0.1534  0.1491  0.1451  0.1412  0.1376  0.1341  0.1308  0.1277  0.1544  0.1544  0.1544  0.1544  0.1544  0.1544  0.1544  0.1544  0.1544  0.1544  0.1544  0.1544  0.1544  0.1544  0.1544 # Offices
    0.1699    0.1700  0.1700  0.1701  0.1701  0.1700  0.1697  0.1694  0.1690  0.1685  0.1680  0.1674  0.1667  0.1867  0.1867  0.1867  0.1867  0.1867  0.1867  0.1867  0.1867  0.1867  0.1867  0.1867  0.1867  0.1867  0.1867  0.1867 # Retail
    0.1782    0.1798  0.1814  0.1830  0.1845  0.1859  0.1871  0.1883  0.1893  0.1903  0.1911  0.1919  0.1926  0.1984  0.1984  0.1984  0.1984  0.1984  0.1984  0.1984  0.1984  0.1984  0.1984  0.1984  0.1984  0.1984  0.1984  0.1984 # Warehouse
    0.1712    0.1712  0.1713  0.1714  0.1714  0.1712  0.1710  0.1707  0.1703  0.1698  0.1693  0.1687  0.1680  0.1867  0.1867  0.1867  0.1867  0.1867  0.1867  0.1867  0.1867  0.1867  0.1867  0.1867  0.1867  0.1867  0.1867  0.1867 # Wholesale
  ]
  #! format: on

  area = Select(Area,"MB")
  #! format: off
  Reduce[eccs, poll, area, years] .= [
    # 2023      2024    2025    2026    2027    2028    2029    2030    2031    2032    2033    2034    2035    2036    2037    2038    2039    2040    2041    2042    2043    2044    2045    2046    2047    2048    2049    2050 #   /VOC
    0.1758    0.1737  0.1715  0.1690  0.1664  0.1639  0.1614  0.1589  0.1565  0.1542  0.1519  0.1496  0.1474  0.1739  0.1739  0.1739  0.1739  0.1739  0.1739  0.1739  0.1739  0.1739  0.1739  0.1739  0.1739  0.1739  0.1739  0.1739 # OtherCommercial
    0.1778    0.1758  0.1736  0.1712  0.1686  0.1662  0.1637  0.1614  0.1590  0.1568  0.1546  0.1524  0.1502  0.1753  0.1753  0.1753  0.1753  0.1753  0.1753  0.1753  0.1753  0.1753  0.1753  0.1753  0.1753  0.1753  0.1753  0.1753 # Education
    0.1987    0.2000  0.2012  0.2022  0.2031  0.2038  0.2045  0.2052  0.2058  0.2064  0.2068  0.2073  0.2076  0.1965  0.1965  0.1965  0.1965  0.1965  0.1965  0.1965  0.1965  0.1965  0.1965  0.1965  0.1965  0.1965  0.1965  0.1965 # Health
    0.1831    0.1835  0.1836  0.1835  0.1832  0.1827  0.1823  0.1818  0.1812  0.1806  0.1800  0.1792  0.1785  0.1906  0.1906  0.1906  0.1906  0.1906  0.1906  0.1906  0.1906  0.1906  0.1906  0.1906  0.1906  0.1906  0.1906  0.1906 # Information
    0.1835    0.1792  0.1749  0.1705  0.1661  0.1619  0.1580  0.1542  0.1506  0.1472  0.1439  0.1407  0.1377  0.1644  0.1644  0.1644  0.1644  0.1644  0.1644  0.1644  0.1644  0.1644  0.1644  0.1644  0.1644  0.1644  0.1644  0.1644 # Offices
    0.1702    0.1722  0.1739  0.1754  0.1767  0.1778  0.1789  0.1799  0.1808  0.1817  0.1824  0.1831  0.1836  0.2030  0.2030  0.2030  0.2030  0.2030  0.2030  0.2030  0.2030  0.2030  0.2030  0.2030  0.2030  0.2030  0.2030  0.2030 # Retail
    0.1644    0.1664  0.1682  0.1698  0.1712  0.1726  0.1738  0.1750  0.1761  0.1771  0.1780  0.1789  0.1796  0.2041  0.2041  0.2041  0.2041  0.2041  0.2041  0.2041  0.2041  0.2041  0.2041  0.2041  0.2041  0.2041  0.2041  0.2041 # Warehouse
    0.1786    0.1807  0.1825  0.1840  0.1854  0.1866  0.1877  0.1888  0.1897  0.1906  0.1914  0.1921  0.1927  0.2030  0.2030  0.2030  0.2030  0.2030  0.2030  0.2030  0.2030  0.2030  0.2030  0.2030  0.2030  0.2030  0.2030  0.2030 # Wholesale
  ]
  #! format: on

  area = Select(Area,"ON")
  #! format: off
  Reduce[eccs, poll, area, years] .= [
    # 2023      2024    2025    2026    2027    2028    2029    2030    2031    2032    2033    2034    2035    2036    2037    2038    2039    2040    2041    2042    2043    2044    2045    2046    2047    2048    2049    2050 #   /VOC
    0.1612    0.1603  0.1594  0.1586  0.1577  0.1568  0.1558  0.1548  0.1537  0.1526  0.1515  0.1503  0.1491  0.1510  0.1510  0.1510  0.1510  0.1510  0.1510  0.1510  0.1510  0.1510  0.1510  0.1510  0.1510  0.1510  0.1510  0.1510 # OtherCommercial
    0.1611    0.1583  0.1558  0.1533  0.1509  0.1486  0.1462  0.1439  0.1416  0.1393  0.1370  0.1348  0.1325  0.1405  0.1405  0.1405  0.1405  0.1405  0.1405  0.1405  0.1405  0.1405  0.1405  0.1405  0.1405  0.1405  0.1405  0.1405 # Education
    0.1752    0.1719  0.1687  0.1657  0.1628  0.1600  0.1572  0.1544  0.1517  0.1490  0.1463  0.1437  0.1411  0.1386  0.1386  0.1386  0.1386  0.1386  0.1386  0.1386  0.1386  0.1386  0.1386  0.1386  0.1386  0.1386  0.1386  0.1386 # Health
    0.1633    0.1682  0.1731  0.1782  0.1834  0.1887  0.1941  0.1996  0.2052  0.2110  0.2168  0.2228  0.2288  0.2000  0.2000  0.2000  0.2000  0.2000  0.2000  0.2000  0.2000  0.2000  0.2000  0.2000  0.2000  0.2000  0.2000  0.2000 # Information
    0.1654    0.1614  0.1577  0.1542  0.1509  0.1477  0.1446  0.1415  0.1385  0.1356  0.1327  0.1299  0.1272  0.1348  0.1348  0.1348  0.1348  0.1348  0.1348  0.1348  0.1348  0.1348  0.1348  0.1348  0.1348  0.1348  0.1348  0.1348 # Offices
    0.1581    0.1583  0.1584  0.1586  0.1588  0.1588  0.1589  0.1588  0.1587  0.1585  0.1582  0.1579  0.1575  0.1585  0.1585  0.1585  0.1585  0.1585  0.1585  0.1585  0.1585  0.1585  0.1585  0.1585  0.1585  0.1585  0.1585  0.1585 # Retail
    0.1500    0.1477  0.1456  0.1436  0.1417  0.1398  0.1379  0.1359  0.1340  0.1320  0.1301  0.1281  0.1261  0.1421  0.1421  0.1421  0.1421  0.1421  0.1421  0.1421  0.1421  0.1421  0.1421  0.1421  0.1421  0.1421  0.1421  0.1421 # Warehouse
    0.1580    0.1581  0.1583  0.1585  0.1586  0.1587  0.1587  0.1587  0.1585  0.1584  0.1581  0.1578  0.1574  0.1585  0.1585  0.1585  0.1585  0.1585  0.1585  0.1585  0.1585  0.1585  0.1585  0.1585  0.1585  0.1585  0.1585  0.1585 # Wholesale
  ]
  #! format: on

  area = Select(Area,"QC")
  #! format: off
  Reduce[eccs, poll, area, years] .= [
    # 2023      2024    2025    2026    2027    2028    2029    2030    2031    2032    2033    2034    2035    2036    2037    2038    2039    2040    2041    2042    2043    2044    2045    2046    2047    2048    2049    2050 #   /VOC
    0.1819    0.1802  0.1785  0.1768  0.1751  0.1735  0.1717  0.1699  0.1681  0.1662  0.1643  0.1623  0.1603  0.1704  0.1704  0.1704  0.1704  0.1704  0.1704  0.1704  0.1704  0.1704  0.1704  0.1704  0.1704  0.1704  0.1704  0.1704 # OtherCommercial
    0.1849    0.1798  0.1750  0.1706  0.1665  0.1625  0.1586  0.1549  0.1513  0.1478  0.1444  0.1411  0.1379  0.1544  0.1544  0.1544  0.1544  0.1544  0.1544  0.1544  0.1544  0.1544  0.1544  0.1544  0.1544  0.1544  0.1544  0.1544 # Education
    0.2018    0.1997  0.1977  0.1957  0.1938  0.1919  0.1899  0.1879  0.1859  0.1839  0.1819  0.1798  0.1777  0.1704  0.1704  0.1704  0.1704  0.1704  0.1704  0.1704  0.1704  0.1704  0.1704  0.1704  0.1704  0.1704  0.1704  0.1704 # Health
    0.1909    0.1984  0.2061  0.2138  0.2217  0.2296  0.2375  0.2454  0.2532  0.2609  0.2685  0.2759  0.2832  0.2395  0.2395  0.2395  0.2395  0.2395  0.2395  0.2395  0.2395  0.2395  0.2395  0.2395  0.2395  0.2395  0.2395  0.2395 # Information
    0.1842    0.1804  0.1769  0.1735  0.1703  0.1672  0.1641  0.1611  0.1582  0.1553  0.1524  0.1496  0.1468  0.1605  0.1605  0.1605  0.1605  0.1605  0.1605  0.1605  0.1605  0.1605  0.1605  0.1605  0.1605  0.1605  0.1605  0.1605 # Offices
    0.1784    0.1781  0.1778  0.1775  0.1772  0.1769  0.1764  0.1759  0.1753  0.1747  0.1740  0.1732  0.1723  0.1805  0.1805  0.1805  0.1805  0.1805  0.1805  0.1805  0.1805  0.1805  0.1805  0.1805  0.1805  0.1805  0.1805  0.1805 # Retail
    0.1836    0.1833  0.1829  0.1826  0.1822  0.1818  0.1813  0.1806  0.1799  0.1791  0.1782  0.1771  0.1760  0.1795  0.1795  0.1795  0.1795  0.1795  0.1795  0.1795  0.1795  0.1795  0.1795  0.1795  0.1795  0.1795  0.1795  0.1795 # Warehouse
    0.1773    0.1770  0.1767  0.1764  0.1761  0.1758  0.1753  0.1748  0.1743  0.1736  0.1729  0.1721  0.1713  0.1805  0.1805  0.1805  0.1805  0.1805  0.1805  0.1805  0.1805  0.1805  0.1805  0.1805  0.1805  0.1805  0.1805  0.1805 # Wholesale
  ]
  #! format: on

  area = Select(Area,"NB")
  #! format: off
  Reduce[eccs, poll, area, years] .= [
    # 2023      2024    2025    2026    2027    2028    2029    2030    2031    2032    2033    2034    2035    2036    2037    2038    2039    2040    2041    2042    2043    2044    2045    2046    2047    2048    2049    2050 #   /VOC
    0.1714    0.1698  0.1684  0.1671  0.1657  0.1642  0.1627  0.1612  0.1598  0.1584  0.1570  0.1557  0.1544  0.1689  0.1689  0.1689  0.1689  0.1689  0.1689  0.1689  0.1689  0.1689  0.1689  0.1689  0.1689  0.1689  0.1689  0.1689 # OtherCommercial
    0.1774    0.1779  0.1785  0.1791  0.1796  0.1800  0.1802  0.1803  0.1805  0.1807  0.1808  0.1810  0.1811  0.1827  0.1827  0.1827  0.1827  0.1827  0.1827  0.1827  0.1827  0.1827  0.1827  0.1827  0.1827  0.1827  0.1827  0.1827 # Education
    0.1842    0.1870  0.1899  0.1927  0.1955  0.1981  0.2005  0.2030  0.2053  0.2077  0.2100  0.2123  0.2145  0.1985  0.1985  0.1985  0.1985  0.1985  0.1985  0.1985  0.1985  0.1985  0.1985  0.1985  0.1985  0.1985  0.1985  0.1985 # Health
    0.1830    0.1904  0.1980  0.2059  0.2140  0.2224  0.2309  0.2396  0.2486  0.2579  0.2674  0.2771  0.2871  0.2418  0.2418  0.2418  0.2418  0.2418  0.2418  0.2418  0.2418  0.2418  0.2418  0.2418  0.2418  0.2418  0.2418  0.2418 # Information
    0.1839    0.1792  0.1750  0.1711  0.1673  0.1636  0.1600  0.1566  0.1534  0.1504  0.1476  0.1449  0.1425  0.1554  0.1554  0.1554  0.1554  0.1554  0.1554  0.1554  0.1554  0.1554  0.1554  0.1554  0.1554  0.1554  0.1554  0.1554 # Offices
    0.1673    0.1711  0.1751  0.1790  0.1831  0.1872  0.1914  0.1956  0.1999  0.2043  0.2088  0.2133  0.2179  0.2124  0.2124  0.2124  0.2124  0.2124  0.2124  0.2124  0.2124  0.2124  0.2124  0.2124  0.2124  0.2124  0.2124  0.2124 # Retail
    0.1828    0.1745  0.1675  0.1612  0.1554  0.1499  0.1447  0.1400  0.1357  0.1319  0.1283  0.1251  0.1221  0.1439  0.1439  0.1439  0.1439  0.1439  0.1439  0.1439  0.1439  0.1439  0.1439  0.1439  0.1439  0.1439  0.1439  0.1439 # Warehouse
    0.1694    0.1733  0.1772  0.1813  0.1854  0.1895  0.1938  0.1980  0.2024  0.2069  0.2114  0.2160  0.2206  0.2124  0.2124  0.2124  0.2124  0.2124  0.2124  0.2124  0.2124  0.2124  0.2124  0.2124  0.2124  0.2124  0.2124  0.2124 # Wholesale
  ]
  #! format: on

  area = Select(Area,"NS")
  #! format: off
  Reduce[eccs, poll, area, years] .= [
    # 2023      2024    2025    2026    2027    2028    2029    2030    2031    2032    2033    2034    2035    2036    2037    2038    2039    2040    2041    2042    2043    2044    2045    2046    2047    2048    2049    2050 #   /VOC
    0.1659    0.1636  0.1614  0.1594  0.1574  0.1555  0.1536  0.1517  0.1498  0.1479  0.1460  0.1442  0.1424  0.1424  0.1424  0.1424  0.1424  0.1424  0.1424  0.1424  0.1424  0.1424  0.1424  0.1424  0.1424  0.1424  0.1424  0.1424 # OtherCommercial
    0.1732    0.1676  0.1624  0.1577  0.1533  0.1491  0.1452  0.1414  0.1378  0.1343  0.1310  0.1278  0.1248  0.1248  0.1248  0.1248  0.1248  0.1248  0.1248  0.1248  0.1248  0.1248  0.1248  0.1248  0.1248  0.1248  0.1248  0.1248 # Education
    0.2009    0.2001  0.1992  0.1985  0.1978  0.1970  0.1962  0.1953  0.1943  0.1933  0.1922  0.1910  0.1898  0.1898  0.1898  0.1898  0.1898  0.1898  0.1898  0.1898  0.1898  0.1898  0.1898  0.1898  0.1898  0.1898  0.1898  0.1898 # Health
    0.1793    0.1881  0.1974  0.2071  0.2173  0.2279  0.2391  0.2508  0.2630  0.2758  0.2892  0.3032  0.3179  0.3179  0.3179  0.3179  0.3179  0.3179  0.3179  0.3179  0.3179  0.3179  0.3179  0.3179  0.3179  0.3179  0.3179  0.3179 # Information
    0.1728    0.1721  0.1714  0.1707  0.1700  0.1694  0.1686  0.1679  0.1671  0.1662  0.1654  0.1645  0.1636  0.1636  0.1636  0.1636  0.1636  0.1636  0.1636  0.1636  0.1636  0.1636  0.1636  0.1636  0.1636  0.1636  0.1636  0.1636 # Offices
    0.1652    0.1666  0.1681  0.1696  0.1710  0.1724  0.1737  0.1750  0.1762  0.1773  0.1784  0.1794  0.1804  0.1804  0.1804  0.1804  0.1804  0.1804  0.1804  0.1804  0.1804  0.1804  0.1804  0.1804  0.1804  0.1804  0.1804  0.1804 # Retail
    0.1738    0.1743  0.1748  0.1754  0.1759  0.1764  0.1767  0.1770  0.1772  0.1773  0.1773  0.1773  0.1772  0.1772  0.1772  0.1772  0.1772  0.1772  0.1772  0.1772  0.1772  0.1772  0.1772  0.1772  0.1772  0.1772  0.1772  0.1772 # Warehouse
    0.1675    0.1690  0.1705  0.1719  0.1734  0.1748  0.1762  0.1775  0.1787  0.1798  0.1809  0.1819  0.1829  0.1829  0.1829  0.1829  0.1829  0.1829  0.1829  0.1829  0.1829  0.1829  0.1829  0.1829  0.1829  0.1829  0.1829  0.1829 # Wholesale
  ]
  #! format: on

  area = Select(Area,"NL")
  #! format: off
  Reduce[eccs, poll, area, years] .= [
    # 2023      2024    2025    2026    2027    2028    2029    2030    2031    2032    2033    2034    2035    2036    2037    2038    2039    2040    2041    2042    2043    2044    2045    2046    2047    2048    2049    2050 #   /VOC
    0.1587    0.1583  0.1580  0.1579  0.1579  0.1579  0.1578  0.1578  0.1578  0.1578  0.1577  0.1577  0.1577  0.1621  0.1621  0.1621  0.1621  0.1621  0.1621  0.1621  0.1621  0.1621  0.1621  0.1621  0.1621  0.1621  0.1621  0.1621 # OtherCommercial
    0.1641    0.1640  0.1642  0.1645  0.1649  0.1653  0.1657  0.1661  0.1666  0.1670  0.1674  0.1678  0.1681  0.1627  0.1627  0.1627  0.1627  0.1627  0.1627  0.1627  0.1627  0.1627  0.1627  0.1627  0.1627  0.1627  0.1627  0.1627 # Education
    0.1847    0.1770  0.1705  0.1649  0.1600  0.1555  0.1513  0.1475  0.1438  0.1405  0.1374  0.1345  0.1317  0.1280  0.1280  0.1280  0.1280  0.1280  0.1280  0.1280  0.1280  0.1280  0.1280  0.1280  0.1280  0.1280  0.1280  0.1280 # Health
    0.1682    0.1760  0.1841  0.1925  0.2013  0.2106  0.2202  0.2303  0.2408  0.2518  0.2633  0.2752  0.2877  0.2467  0.2467  0.2467  0.2467  0.2467  0.2467  0.2467  0.2467  0.2467  0.2467  0.2467  0.2467  0.2467  0.2467  0.2467 # Information
    0.1684    0.1658  0.1636  0.1618  0.1602  0.1586  0.1572  0.1558  0.1544  0.1531  0.1519  0.1508  0.1496  0.1481  0.1481  0.1481  0.1481  0.1481  0.1481  0.1481  0.1481  0.1481  0.1481  0.1481  0.1481  0.1481  0.1481  0.1481 # Offices
    0.1661    0.1629  0.1602  0.1579  0.1558  0.1538  0.1519  0.1501  0.1484  0.1467  0.1452  0.1437  0.1422  0.1447  0.1447  0.1447  0.1447  0.1447  0.1447  0.1447  0.1447  0.1447  0.1447  0.1447  0.1447  0.1447  0.1447  0.1447 # Retail
    0.1641    0.1642  0.1646  0.1651  0.1657  0.1663  0.1668  0.1674  0.1680  0.1685  0.1691  0.1696  0.1701  0.1650  0.1650  0.1650  0.1650  0.1650  0.1650  0.1650  0.1650  0.1650  0.1650  0.1650  0.1650  0.1650  0.1650  0.1650 # Warehouse
    0.1787    0.1752  0.1723  0.1698  0.1675  0.1654  0.1634  0.1614  0.1596  0.1578  0.1562  0.1546  0.1530  0.1447  0.1447  0.1447  0.1447  0.1447  0.1447  0.1447  0.1447  0.1447  0.1447  0.1447  0.1447  0.1447  0.1447  0.1447 # Wholesale
  ]
  #! format: on

  area = Select(Area,"PE")
  #! format: off
  Reduce[eccs, poll, area, years] .= [
    # 2023      2024    2025    2026    2027    2028    2029    2030    2031    2032    2033    2034    2035    2036    2037    2038    2039    2040    2041    2042    2043    2044    2045    2046    2047    2048    2049    2050 #   /VOC
    0.1646    0.1577  0.1514  0.1459  0.1411  0.1367  0.1327  0.1291  0.1256  0.1223  0.1191  0.1161  0.1132  0.0692  0.0692  0.0692  0.0692  0.0692  0.0692  0.0692  0.0692  0.0692  0.0692  0.0692  0.0692  0.0692  0.0692  0.0692 # OtherCommercial
    0.1600    0.1565  0.1532  0.1504  0.1478  0.1455  0.1434  0.1415  0.1395  0.1377  0.1359  0.1341  0.1324  0.0789  0.0789  0.0789  0.0789  0.0789  0.0789  0.0789  0.0789  0.0789  0.0789  0.0789  0.0789  0.0789  0.0789  0.0789 # Education
    0.1702    0.1738  0.1774  0.1810  0.1848  0.1886  0.1924  0.1962  0.2000  0.2038  0.2074  0.2110  0.2145  0.1168  0.1168  0.1168  0.1168  0.1168  0.1168  0.1168  0.1168  0.1168  0.1168  0.1168  0.1168  0.1168  0.1168  0.1168 # Health
    0.1645    0.1726  0.1810  0.1898  0.1990  0.2087  0.2187  0.2292  0.2400  0.2513  0.2630  0.2751  0.2876  0.1788  0.1788  0.1788  0.1788  0.1788  0.1788  0.1788  0.1788  0.1788  0.1788  0.1788  0.1788  0.1788  0.1788  0.1788 # Information
    0.1600    0.1608  0.1615  0.1623  0.1632  0.1642  0.1651  0.1661  0.1670  0.1679  0.1687  0.1694  0.1701  0.1020  0.1020  0.1020  0.1020  0.1020  0.1020  0.1020  0.1020  0.1020  0.1020  0.1020  0.1020  0.1020  0.1020  0.1020 # Offices
    0.1558    0.1574  0.1589  0.1606  0.1622  0.1639  0.1656  0.1673  0.1689  0.1706  0.1721  0.1737  0.1751  0.1131  0.1131  0.1131  0.1131  0.1131  0.1131  0.1131  0.1131  0.1131  0.1131  0.1131  0.1131  0.1131  0.1131  0.1131 # Retail
    0.1573    0.1514  0.1460  0.1412  0.1370  0.1332  0.1297  0.1266  0.1236  0.1207  0.1180  0.1154  0.1129  0.0727  0.0727  0.0727  0.0727  0.0727  0.0727  0.0727  0.0727  0.0727  0.0727  0.0727  0.0727  0.0727  0.0727  0.0727 # Warehouse
    0.1525    0.1541  0.1556  0.1571  0.1588  0.1604  0.1621  0.1637  0.1654  0.1669  0.1685  0.1700  0.1714  0.1131  0.1131  0.1131  0.1131  0.1131  0.1131  0.1131  0.1131  0.1131  0.1131  0.1131  0.1131  0.1131  0.1131  0.1131 # Wholesale
  ]
  #! format: on

  area = Select(Area,"YT")
  #! format: off
  Reduce[eccs, poll, area, years] .= [
    # 2023      2024    2025    2026    2027    2028    2029    2030    2031    2032    2033    2034    2035    2036    2037    2038    2039    2040    2041    2042    2043    2044    2045    2046    2047    2048    2049    2050 #   /VOC
    0.1225    0.1190  0.1156  0.1124  0.1092  0.1059  0.1027  0.0999  0.0970  0.0941  0.0918  0.0898  0.0881  0.1010  0.1010  0.1010  0.1010  0.1010  0.1010  0.1010  0.1010  0.1010  0.1010  0.1010  0.1010  0.1010  0.1010  0.1010 # OtherCommercial
    0.1189    0.1169  0.1149  0.1131  0.1112  0.1091  0.1072  0.1056  0.1038  0.1019  0.1006  0.0997  0.0990  0.1088  0.1088  0.1088  0.1088  0.1088  0.1088  0.1088  0.1088  0.1088  0.1088  0.1088  0.1088  0.1088  0.1088  0.1088 # Education
    0.1209    0.1183  0.1157  0.1133  0.1108  0.1082  0.1058  0.1037  0.1014  0.0991  0.0974  0.0960  0.0948  0.1054  0.1054  0.1054  0.1054  0.1054  0.1054  0.1054  0.1054  0.1054  0.1054  0.1054  0.1054  0.1054  0.1054  0.1054 # Health
    0.1332    0.1262  0.1197  0.1139  0.1083  0.1028  0.0978  0.0934  0.0890  0.0848  0.0814  0.0784  0.0757  0.0883  0.0883  0.0883  0.0883  0.0883  0.0883  0.0883  0.0883  0.0883  0.0883  0.0883  0.0883  0.0883  0.0883  0.0883 # Information
    0.1263    0.1228  0.1194  0.1163  0.1131  0.1098  0.1067  0.1040  0.1011  0.0982  0.0960  0.0942  0.0925  0.1017  0.1017  0.1017  0.1017  0.1017  0.1017  0.1017  0.1017  0.1017  0.1017  0.1017  0.1017  0.1017  0.1017  0.1017 # Offices
    0.1113    0.1107  0.1100  0.1095  0.1089  0.1081  0.1074  0.1070  0.1063  0.1056  0.1055  0.1057  0.1061  0.1178  0.1178  0.1178  0.1178  0.1178  0.1178  0.1178  0.1178  0.1178  0.1178  0.1178  0.1178  0.1178  0.1178  0.1178 # Retail
    0.1229    0.1225  0.1219  0.1213  0.1205  0.1193  0.1181  0.1171  0.1156  0.1140  0.1130  0.1122  0.1116  0.1182  0.1182  0.1182  0.1182  0.1182  0.1182  0.1182  0.1182  0.1182  0.1182  0.1182  0.1182  0.1182  0.1182  0.1182 # Warehouse
    0.1343    0.1335  0.1327  0.1320  0.1313  0.1303  0.1295  0.1290  0.1282  0.1273  0.1272  0.1274  0.1279  0.1178  0.1178  0.1178  0.1178  0.1178  0.1178  0.1178  0.1178  0.1178  0.1178  0.1178  0.1178  0.1178  0.1178  0.1178 # Wholesale
  ]
  #! format: on

  area = Select(Area,"NT")
  #! format: off
  Reduce[eccs, poll, area, years] .= [
    # 2023      2024    2025    2026    2027    2028    2029    2030    2031    2032    2033    2034    2035    2036    2037    2038    2039    2040    2041    2042    2043    2044    2045    2046    2047    2048    2049    2050 #   /VOC
    0.1089    0.1080  0.1071  0.1060  0.1049  0.1039  0.1027  0.1013  0.1000  0.0988  0.0972  0.0954  0.0934  0.1204  0.1204  0.1204  0.1204  0.1204  0.1204  0.1204  0.1204  0.1204  0.1204  0.1204  0.1204  0.1204  0.1204  0.1204 # OtherCommercial
    0.1067    0.1071  0.1074  0.1077  0.1079  0.1081  0.1082  0.1081  0.1080  0.1080  0.1075  0.1069  0.1060  0.1297  0.1297  0.1297  0.1297  0.1297  0.1297  0.1297  0.1297  0.1297  0.1297  0.1297  0.1297  0.1297  0.1297  0.1297 # Education
    0.1102    0.1100  0.1098  0.1095  0.1091  0.1088  0.1084  0.1077  0.1071  0.1066  0.1056  0.1044  0.1030  0.1256  0.1256  0.1256  0.1256  0.1256  0.1256  0.1256  0.1256  0.1256  0.1256  0.1256  0.1256  0.1256  0.1256  0.1256 # Health
    0.1090    0.1054  0.1021  0.0988  0.0957  0.0928  0.0900  0.0871  0.0844  0.0819  0.0793  0.0766  0.0739  0.1053  0.1053  0.1053  0.1053  0.1053  0.1053  0.1053  0.1053  0.1053  0.1053  0.1053  0.1053  0.1053  0.1053  0.1053 # Information
    0.1092    0.1083  0.1075  0.1066  0.1056  0.1047  0.1037  0.1025  0.1013  0.1002  0.0988  0.0971  0.0953  0.1213  0.1213  0.1213  0.1213  0.1213  0.1213  0.1213  0.1213  0.1213  0.1213  0.1213  0.1213  0.1213  0.1213  0.1213 # Offices
    0.0990    0.1005  0.1019  0.1032  0.1046  0.1060  0.1073  0.1084  0.1096  0.1108  0.1116  0.1122  0.1125  0.1404  0.1404  0.1404  0.1404  0.1404  0.1404  0.1404  0.1404  0.1404  0.1404  0.1404  0.1404  0.1404  0.1404  0.1404 # Retail
    0.1090    0.1109  0.1126  0.1141  0.1155  0.1168  0.1177  0.1183  0.1189  0.1194  0.1193  0.1188  0.1180  0.1408  0.1408  0.1408  0.1408  0.1408  0.1408  0.1408  0.1408  0.1408  0.1408  0.1408  0.1408  0.1408  0.1408  0.1408 # Warehouse
    0.1186    0.1203  0.1220  0.1237  0.1253  0.1270  0.1286  0.1299  0.1313  0.1328  0.1337  0.1343  0.1347  0.1404  0.1404  0.1404  0.1404  0.1404  0.1404  0.1404  0.1404  0.1404  0.1404  0.1404  0.1404  0.1404  0.1404  0.1404 # Wholesale
  ]
  #! format: on

  area = Select(Area,"NU")
  #! format: off
  Reduce[eccs, poll, area, years] .= [
    # 2023      2024    2025    2026    2027    2028    2029    2030    2031    2032    2033    2034    2035    2036    2037    2038    2039    2040    2041    2042    2043    2044    2045    2046    2047    2048    2049    2050 #   /VOC
    0.1255    0.1233  0.1212  0.1190  0.1168  0.1147  0.1124  0.1099  0.1076  0.1053  0.1027  0.0999  0.0970  0.1100  0.1100  0.1100  0.1100  0.1100  0.1100  0.1100  0.1100  0.1100  0.1100  0.1100  0.1100  0.1100  0.1100  0.1100 # OtherCommercial
    0.1239    0.1232  0.1225  0.1217  0.1209  0.1202  0.1193  0.1181  0.1170  0.1160  0.1145  0.1127  0.1108  0.1184  0.1184  0.1184  0.1184  0.1184  0.1184  0.1184  0.1184  0.1184  0.1184  0.1184  0.1184  0.1184  0.1184  0.1184 # Education
    0.1273    0.1260  0.1247  0.1233  0.1219  0.1205  0.1190  0.1172  0.1156  0.1140  0.1119  0.1097  0.1073  0.1147  0.1147  0.1147  0.1147  0.1147  0.1147  0.1147  0.1147  0.1147  0.1147  0.1147  0.1147  0.1147  0.1147  0.1147 # Health
    0.1359    0.1303  0.1251  0.1201  0.1154  0.1109  0.1066  0.1023  0.0983  0.0946  0.0907  0.0868  0.0830  0.0961  0.0961  0.0961  0.0961  0.0961  0.0961  0.0961  0.0961  0.0961  0.0961  0.0961  0.0961  0.0961  0.0961  0.0961 # Information
    0.1288    0.1267  0.1246  0.1225  0.1204  0.1184  0.1162  0.1139  0.1116  0.1095  0.1069  0.1042  0.1014  0.1107  0.1107  0.1107  0.1107  0.1107  0.1107  0.1107  0.1107  0.1107  0.1107  0.1107  0.1107  0.1107  0.1107  0.1107 # Offices
    0.1150    0.1157  0.1163  0.1169  0.1175  0.1181  0.1185  0.1187  0.1189  0.1192  0.1190  0.1185  0.1177  0.1282  0.1282  0.1282  0.1282  0.1282  0.1282  0.1282  0.1282  0.1282  0.1282  0.1282  0.1282  0.1282  0.1282  0.1282 # Retail
    0.1297    0.1308  0.1317  0.1323  0.1328  0.1332  0.1331  0.1326  0.1321  0.1315  0.1302  0.1285  0.1265  0.1286  0.1286  0.1286  0.1286  0.1286  0.1286  0.1286  0.1286  0.1286  0.1286  0.1286  0.1286  0.1286  0.1286  0.1286 # Warehouse
    0.1378    0.1386  0.1394  0.1401  0.1407  0.1414  0.1420  0.1422  0.1425  0.1428  0.1426  0.1419  0.1411  0.1282  0.1282  0.1282  0.1282  0.1282  0.1282  0.1282  0.1282  0.1282  0.1282  0.1282  0.1282  0.1282  0.1282  0.1282 # Wholesale
  ]
  #! format: on

  #
  # Apply reductions to coefficient
  #
  CN = Select(Nation,"CN")
  areas = findall(ANMap[:,CN] .== 1)

  for year in years, area in areas, ecc in eccs
    MEPOCX[ecc,poll,area,year] = MEPOCX[ecc,poll,area,year]*
      (1-Reduce[ecc,poll,area,year])
  end

  WriteDisk(db,"MEInput/MEPOCX",MEPOCX)
end

function PolicyControl(db)
  @info "CAC_VOC_Products.jl - PolicyControl"
  ResPolicy(db)
  ComPolicy(db)
end

if abspath(PROGRAM_FILE) == @__FILE__
  PolicyControl(DB)
end

end
